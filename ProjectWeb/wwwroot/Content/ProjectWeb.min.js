(function(n){"use strict";Date.now||(Date.now=function(){return(new Date).getTime()});Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)});Object.setPrototypeOf||(Object.setPrototypeOf=function(n,t){return n.__proto__=t,n});n.WebSharper={Runtime:{Ctor:function(n,t){return n.prototype=t.prototype,n},Class:function(n,t,i){var u=n,f,r,e;if(t){u=new t;for(f in n)u[f]=n[f]}if(r=function(n){if(n)for(var t in n)this[t]=n[t]},r.prototype=u,i)for(e in i)r[e]=i[e];return r},Clone:function(n){var t={};for(var i of Object.getOwnPropertyNames(n))t[i]=n[i];return Object.setPrototypeOf(t,Object.getPrototypeOf(n)),t},NewObject:function(n){for(var i={},t=0;t<n.length;t++)i[n[t][0]]=n[t][1];return i},PrintObject:function(n){var t="{ ",i=!0;for(var r of Object.getOwnPropertyNames(n))i?i=!1:t+=", ",t+=r+" = "+n[r];return t+(i?"}":" }")},DeleteEmptyFields:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]===void 0&&delete n[r];return n},GetOptional:function(n){return n===void 0?null:{$:1,$0:n}},SetOptional:function(n,t,i){i?n[t]=i.$0:delete n[t]},SetOrDelete:function(n,t,i){i===void 0?delete n[t]:n[t]=i},Apply:function(n,t,i){return n.apply(t,i)},Bind:function(n){return function(){return n.apply(this,arguments)}},CreateFuncWithArgs:function(n){return function(){return n(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(n){return function(){return n(this)}},CreateFuncWithThis:function(n){return function(){return n(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(n){return function(){return n(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(n,t){return function(){return t(Array.prototype.slice.call(arguments,0,n).concat([Array.prototype.slice.call(arguments,n)]))}},CreateFuncWithArgsRest:function(n,t){return function(){return t([Array.prototype.slice.call(arguments,0,n),Array.prototype.slice.call(arguments,n)])}},BindDelegate:function(n,t){var i=n.bind(t);return i.$Func=n,i.$Target=t,i},CreateDelegate:function(n){if(n.length==0)return null;if(n.length==1)return n[0];var t=function(){for(var i,t=0;t<n.length;t++)i=n[t].apply(null,arguments);return i};return t.$Invokes=n,t},CombineDelegates:function(n){for(var t,i=[],r=0;r<n.length;r++)t=n[r],t&&("$Invokes"in t?i=i.concat(t.$Invokes):i.push(t));return WebSharper.Runtime.CreateDelegate(i)},DelegateEqual:function(n,t){var f,e,i,r,u;if(n===t)return!0;if(n==null||t==null||(f=n.$Invokes||[n],e=t.$Invokes||[t],f.length!=e.length))return!1;for(i=0;i<f.length;i++)if(r=f[i],u=e[i],!(r===u||"$Func"in r&&"$Func"in u&&r.$Func===u.$Func&&r.$Target==u.$Target))return!1;return!0},ThisFunc:function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),n.apply(null,t)}},ThisFuncOut:function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(t.shift(),t)}},ParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat([i.slice(n)]))}},ParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat(i[n]))}},ThisParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this),t.apply(null,i.slice(0,n+1).concat([i.slice(n+1)]))}},ThisParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(i.shift(),i.slice(0,n).concat(i[n]))}},Curried:function(n,t,i){return i=i||[],function(r){var u=i.concat([r===void 0?null:r]);return t==1?n.apply(null,u):t==2?function(t){return n.apply(null,u.concat([t===void 0?null:t]))}:WebSharper.Runtime.Curried(n,t-1,u)}},Curried2:function(n){return function(t){return function(i){return n(t,i)}}},Curried3:function(n){return function(t){return function(i){return function(r){return n(t,i,r)}}}},UnionByType:function(n,t,i){for(var u,f=typeof t,r=0;r<n.length;r++)if(u=n[r],typeof u=="number"){if(Array.isArray(t)&&(u==0||t.length==u))return{$:r,$0:t}}else if(u==f)return{$:r,$0:t};if(!i)throw new Error("Type not expected for creating Choice value.");},MarkResizable:function(n){return Object.defineProperty(n,"resizable",{enumerable:!1,writable:!1,configurable:!1,value:!0}),n},MarkReadOnly:function(n){return Object.defineProperty(n,"readonly",{enumerable:!1,writable:!1,configurable:!1,value:!0}),n},ScriptBasePath:"./",ScriptPath:function(n,t){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":n+"/")+t},OnLoad:function(n){"load"in this||(this.load=[]);this.load.push(n)},Start:function(){function n(n){for(var t=0;t<n.length;t++)n[t]()}"load"in this&&(n(this.load),this.load=[])}}};n.WebSharper.Runtime.OnLoad(function(){n.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()});n.ignore=function(){};n.id=function(n){return n};n.fst=function(n){return n[0]};n.snd=function(n){return n[1]};n.trd=function(n){return n[2]};n.console||(n.console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore})})(self);
/* https://github.com/jonathantneal/closest */
(function(w,p){p=w.Element.prototype
if(!p.matches){p.matches=p.msMatchesSelector||function(s){var m=(this.document||this.ownerDocument).querySelectorAll(s);for(var i=0;m[i]&&m[i]!==e;++i);return!!m[i]}}
if(!p.closest){p.closest=function(s){var e=this;while(e&&e.nodeType==1){if(e.matches(s))return e;e=e.parentNode}return null}}})(self);
(function(){for(var i=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),u=window.setTimeout(function(){n(t+r)},r);return i=t+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})})();
(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS;b=a.ProjectWeb=a.ProjectWeb||{};c=b.ContactManager=b.ContactManager||{};d=c.Contact=c.Contact||{};e=a.WebSharper=a.WebSharper||{};f=e.Operators=e.Operators||{};g=e.Forms=e.Forms||{};h=g.Form=g.Form||{};i=e.Obj=e.Obj||{};j=e.UI=e.UI||{};k=j.Var=j.Var||{};l=e.List=e.List||{};m=l.T=l.T||{};n=e.JavaScript=e.JavaScript||{};o=n.JS=n.JS||{};p=a.StartupCode$ProjectWeb$Client=a.StartupCode$ProjectWeb$Client||{};q=n.Pervasives=n.Pervasives||{};r=j.Doc=j.Doc||{};s=j.View=j.View||{};t=j.HtmlModule=j.HtmlModule||{};u=t.attr=t.attr||{};v=g.View=g.View||{};w=j.Submitter=j.Submitter||{};x=e.Utils=e.Utils||{};y=j.Client=j.Client||{};z=y.Templates=y.Templates||{};A=g.Pervasives=g.Pervasives||{};B=g.Validation=g.Validation||{};C=g.Result=g.Result||{};D=j.Var$1=j.Var$1||{};E=j.Snap=j.Snap||{};F=j.AttrProxy=j.AttrProxy||{};G=e.Seq=e.Seq||{};H=g.ErrorMessage=g.ErrorMessage||{};I=e.Unchecked=e.Unchecked||{};J=a.EventTarget;K=a.Node;L=e.Collections=e.Collections||{};M=L.Dictionary=L.Dictionary||{};N=g.Fresh=g.Fresh||{};O=a.Object;P=j.ConcreteVar=j.ConcreteVar||{};Q=j.Docs=j.Docs||{};R=j.Attrs=j.Attrs||{};S=j.DomUtility=j.DomUtility||{};T=j.AttrModule=j.AttrModule||{};U=j.Array=j.Array||{};V=e.Enumerator=e.Enumerator||{};W=V.T=V.T||{};X=e.Arrays=e.Arrays||{};Y=a.StartupCode$WebSharper_UI$Templates=a.StartupCode$WebSharper_UI$Templates||{};Z=L.HashSet=L.HashSet||{};_0=a.WindowOrWorkerGlobalScope;_1=j.Abbrev=j.Abbrev||{};_2=_1.Fresh=_1.Fresh||{};_3=j.DocElemNode=j.DocElemNode||{};_4=a.CharacterData;_5=j.BindVar=j.BindVar||{};_6=j.Elt=j.Elt||{};_7=L.DictionaryUtil=L.DictionaryUtil||{};_8=a.Element;_9=z.Prepare=z.Prepare||{};_=e.Slice=e.Slice||{};$=L.KeyCollection=L.KeyCollection||{};ba=e.Numeric=e.Numeric||{};bb=j.An=j.An||{};bc=y.Settings=y.Settings||{};bd=_1.Mailbox=_1.Mailbox||{};be=a.StartupCode$WebSharper_Forms$Forms=a.StartupCode$WebSharper_Forms$Forms||{};bf=y.Attrs=y.Attrs||{};bg=bf.Dyn=bf.Dyn||{};bh=a.StartupCode$WebSharper_UI$Attr_Client=a.StartupCode$WebSharper_UI$Attr_Client||{};bi=j.Updates=j.Updates||{};bj=e.Strings=e.Strings||{};bk=y.Docs=y.Docs||{};bl=bk.RunState=bk.RunState||{};bm=bk.NodeSet=bk.NodeSet||{};bn=e.Concurrency=e.Concurrency||{};bo=j.Anims=j.Anims||{};bp=a.StartupCode$WebSharper_UI$Doc_Proxy=a.StartupCode$WebSharper_UI$Doc_Proxy||{};bq=a.StartupCode$WebSharper_UI$Abbrev=a.StartupCode$WebSharper_UI$Abbrev||{};br=e.Queue=e.Queue||{};bs=j.String=j.String||{};bt=j.CheckedInput=j.CheckedInput||{};bu=a.StartupCode$WebSharper_UI$DomUtility=a.StartupCode$WebSharper_UI$DomUtility||{};bv=a.StartupCode$WebSharper_UI$Animation=a.StartupCode$WebSharper_UI$Animation||{};bw=j.AppendList=j.AppendList||{};bx=L.HashSetUtil=L.HashSetUtil||{};by=j.DynamicAttrNode=j.DynamicAttrNode||{};bz=e.Char=e.Char||{};bA=e.DateUtil=e.DateUtil||{};bB=a.Error;bC=e.KeyNotFoundException=e.KeyNotFoundException||{};bD=bn.Scheduler=bn.Scheduler||{};bE=j.Easing=j.Easing||{};bF=bn.AsyncBody=bn.AsyncBody||{};bG=a.StartupCode$WebSharper_Main$Concurrency=a.StartupCode$WebSharper_Main$Concurrency||{};bH=bn.CT=bn.CT||{};bI=_1.HashSet=_1.HashSet||{};bJ=e.CancellationTokenSource=e.CancellationTokenSource||{};bK=bk.DomNodes=bk.DomNodes||{};bL=e.OperationCanceledException=e.OperationCanceledException||{};bM=e.Lazy=e.Lazy||{};bN=a.StartupCode$WebSharper_UI$AppendList=a.StartupCode$WebSharper_UI$AppendList||{};bO=e.LazyExtensionsProxy=e.LazyExtensionsProxy||{};bP=bO.LazyRecord=bO.LazyRecord||{};bQ=e&&e.Runtime;bR=a.console;bS=a.Date;c.Main=function(){var bT,bU;bT=d.New("","","","","");bU=h.Render(bQ.Curried(c.RenderContact,6),h.Run(function(bV){var bW,bX;bW=c.editIndex().Get();if(bW==null)c.contactList().Set(new m({$:1,$0:bV,$1:c.contactList().Get()}));else{bX=bW.$0;c.contactList().Set(l.mapi(function(bY,bZ){return bY===bX?bV:bZ;},c.contactList().Get()));c.editIndex().Set(null);}a.alert("Your Contact: "+bV.firstName+" "+bV.lastName+"!");bT=d.New("","","","","");},c.ContactForm(bT)));z.LoadLocalTemplates("");r.RunById("main",bU);};c.editIndex=function(){p.$cctor();return p.editIndex;};c.contactList=function(){p.$cctor();return p.contactList;};c.RenderContact=function(bT,bU,bV,bW,bX,bY){return r.Element("section",[F.Create("class","section")],[r.Element("h2",[F.Create("class","subtitle")],[r.TextNode("Contact Manager")]),r.Element("p",[F.Create("class","subhead")],[r.TextNode("A simple Website that stores, Updates and Deletes Contact Information")]),r.Element("div",[F.Create("class","field")],[r.Element("label",[F.Create("class","label")],[r.TextNode("First name: "),r.Input([F.Create("class","input")],bT)]),c.ShowErrorsFor(v.Through$1(bY.view,bT))]),r.Element("div",[F.Create("class","field")],[r.Element("label",[F.Create("class","label")],[r.TextNode("Last name: "),r.Input([F.Create("class","input")],bU)]),c.ShowErrorsFor(v.Through$1(bY.view,bU))]),r.Element("div",[F.Create("class","field")],[r.Element("label",[F.Create("class","label")],[r.TextNode("Email: "),r.EmailInput([F.Create("class","input")],bV)]),c.ShowErrorsFor(v.Through$1(bY.view,bV))]),r.Element("div",[F.Create("class","field")],[r.Element("label",[F.Create("class","label")],[r.TextNode("Phone: "),r.Input([F.Create("class","input")],bW)]),c.ShowErrorsFor(v.Through$1(bY.view,bW))]),r.Element("div",[F.Create("class","field")],[r.Element("label",[F.Create("class","label")],[r.TextNode("Address: "),r.Input([F.Create("class","input")],bX)]),c.ShowErrorsFor(v.Through$1(bY.view,bX))]),r.Element("div",[],[r.Button("Submit",[F.Create("class","button")],function(){bY.Trigger();})]),r.Element("div",[],[r.Button("View Contacts",[F.Create("class","button")],function(){c.showModal();})]),r.EmbedView(s.Map(function(bZ){return bZ?r.Element("div",[F.Create("class","modal is-active")],[r.Element("div",[F.Create("class","modal-background")],[r.Button("",[],function(){c.hideModal();})]),r.Element("div",[F.Create("class","modal-content")],[r.Element("div",[F.Create("class","box")],[r.Element("h2",[F.Create("class","subtitle")],[r.TextNode("Contact List")]),r.BindView(function(b0){return b0.$==0?r.Element("p",[],[r.TextNode("No Contacts available")]):r.Element("ul",[F.Create("class","listing")],l.mapi(function(b1,b2){return r.Element("li",[],[r.TextNode("* - "+x.toSafe(b2.firstName)+" "+x.toSafe(b2.lastName)+" ("+x.toSafe(b2.email)+", "+x.toSafe(b2.phone)+", "+x.toSafe(b2.address)+")"),r.Button("Edit",[F.Create("class","button is-small")],function(){c.editIndex().Set({$:1,$0:b1});bT.Set(b2.firstName);bU.Set(b2.lastName);bV.Set(b2.email);bW.Set(b2.phone);bX.Set(b2.address);}),r.Button("Delete",[F.Create("class","button is-small")],function(){c.contactList().Set(l.choose(a.id,l.mapi(function(b3,b4){return b3!==b1?{$:1,$0:b4}:null;},c.contactList().Get())));})]);},b0));},c.contactList().get_View())])]),r.Element("div",[F.Create("class","modal-close is-large")],[r.Button("",[],function(){c.hideModal();})])]):r.get_Empty();},c.modalVisible().get_View()))]);};c.ContactForm=function(bT){return h.WithSubmit(A.op_LessMultiplyGreater(A.op_LessMultiplyGreater(A.op_LessMultiplyGreater(A.op_LessMultiplyGreater(A.op_LessMultiplyGreater(h.Return(bQ.Curried(d.New,5)),B.IsNotEmpty("Please enter the first name.",h.Yield(bT.firstName))),B.IsNotEmpty("Please enter the last name.",h.Yield(bT.lastName))),B.IsMatch("^\\w+([-+.']\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*$","Invalid email address.",h.Yield(bT.email))),B.IsMatch("^[0-9]+$","Invalid phone number format.",h.Yield(bT.phone))),h.Yield(bT.address)));};c.ShowErrorsFor=function(bT){return r.EmbedView(s.Map(function(bU){var bV;return bU.$==1?(bV=bU.$0,r.Concat(l.ofSeq(G.delay(function(){return G.map(function(bW){return r.Element("b",[F.Create("style","color:red")],[r.TextNode(bW.message)]);},bV);})))):r.get_Empty();},bT));};c.showModal=function(){c.modalVisible().Set(true);};c.modalVisible=function(){p.$cctor();return p.modalVisible;};c.hideModal=function(){c.modalVisible().Set(false);};d.New=function(bT,bU,bV,bW,bX){return{firstName:bT,lastName:bU,email:bV,phone:bW,address:bX};};f.FailWith=function(bT){throw new bB(bT);};f.KeyValue=function(bT){return[bT.K,bT.V];};f.range=function(bT,bU){var bV;bV=1+bU-bT;return bV<=0?[]:G.init(bV,function(bW){return bW+bT;});};h.Run=function(bT,bU){return h.Map(function(bV){bT(bV);return bV;},bU);};h.Render=function(bT,bU){var bV;bV=bU.render(bT);return r.Append(r.EmbedView(s.Map(function(){return r.get_Empty();},bU.view)),bV);};h.Map=function(bT,bU){return h.MapResult(function(bV){return C.Map(bT,bV);},bU);};h.Return=function(bT){return h.New(N.Id(),s.Const({$:0,$0:bT}),a.id);};h.Yield=function(bT){return h.YieldVar(D.Create$1(bT));};h.WithSubmit=function(bT){var bU;bU=new w.New(bT.view,{$:1,$0:m.Empty});return h.New(N.Id(),bU.view,function(bV){return(bT.render(bV))(bU);});};h.MapResult=function(bT,bU){return h.New(bU.id,s.Map(bT,bU.view),bU.render);};h.Apply=function(bT,bU){var bV,bW;return h.New(N.Id(),s.Map2(C.Apply,bT.view,bU.view),(bV=bT.render,(bW=bU.render,function(bX){return bW(bV(bX));})));};h.YieldVar=function(bT){return h.New(bT.get_Id(),s.Map(function(bU){return{$:0,$0:bU};},bT.get_View()),function(bU){return bU(bT);});};i=e.Obj=bQ.Class({Equals:function(bT){return this===bT;},GetHashCode:function(){return -1;}},null,i);i.New=bQ.Ctor(function(){},i);k=j.Var=bQ.Class({},i,k);k.New=bQ.Ctor(function(){i.New.call(this);},k);m=l.T=bQ.Class({GetEnumerator:function(){return new W.New(this,null,function(bT){var bU;bU=bT.s;return bU.$==0?false:(bT.c=bU.$0,bT.s=bU.$1,true);},void 0);}},null,m);m.Empty=new m({$:0});l.mapi=function(bT,bU){var bV,bW,bX,bY,bZ,b0;if(bU.$==0)return bU;else{bZ=new m({$:1});bV=bZ;bW=bU;bX=0;bY=true;while(bY){bV.$0=bT(bX,bW.$0);bW=bW.$1;if(bW.$==0)bY=false;else{bV=(b0=new m({$:1}),bV.$1=b0,b0);bX=bX+1;}}bV.$1=m.Empty;return bZ;}};l.choose=function(bT,bU){return l.ofSeq(G.choose(bT,bU));};l.filter=function(bT,bU){var bV,bW,bX,bY,bZ,b0;if(bU.$==0)return bU;else{bV=m.Empty;bW=bV;bX=bU;bY=true;while(bY){if(bT(bX.$0)){bV.$==0?(bV=new m({$:1}),bW=bV):bW=(bZ=new m({$:1}),bW.$1=bZ,bZ);b0=bX.$0;bW.$=1;bW.$0=b0;}bX=bX.$1;if(bX.$==0)bY=false;}if(!(bV.$==0))bW.$1=m.Empty;return bV;}};l.ofSeq=function(bT){var bU,bV,bW,bX,bY,bZ;if(bT instanceof m)return bT;else if(bT instanceof a.Array)return l.ofArray(bT);else{bU=V.Get(bT);try{bW=bU.MoveNext();if(!bW)bV=m.Empty;else{bY=new m({$:1});bX=bY;while(bW){bX.$0=bU.Current();if(bU.MoveNext())bX=(bZ=new m({$:1}),bX.$1=bZ,bZ);else bW=false;}bX.$1=m.Empty;bV=bY;}return bV;}finally{if(typeof bU=="object"&&"Dispose"in bU)bU.Dispose();}}};l.ofArray=function(bT){var bU,bV,bW;bU=m.Empty;for(bV=X.length(bT)-1,bW=0;bV>=bW;bV--)bU=new m({$:1,$0:X.get(bT,bV),$1:bU});return bU;};l.append=function(bT,bU){var bV,bW,bX,bY,bZ;if(bT.$==0)return bU;else if(bU.$==0)return bT;else{bY=new m({$:1});bV=bY;bW=bT;bX=true;while(bX){bV.$0=bW.$0;bW=bW.$1;if(bW.$==0)bX=false;else bV=(bZ=new m({$:1}),bV.$1=bZ,bZ);}bV.$1=bU;return bY;}};l.head=function(bT){return bT.$==1?bT.$0:l.listEmpty();};l.tail=function(bT){return bT.$==1?bT.$1:l.listEmpty();};l.listEmpty=function(){return f.FailWith("The input list was empty.");};o.GetFieldValues=function(bT){var bU,bV;bU=[];for(var bW in bT)bU.push(bT[bW]);return bU;};p.$cctor=function(){p.$cctor=a.ignore;p.contactList=D.Create$1(m.Empty);p.editIndex=D.Create$1(null);p.modalVisible=D.Create$1(false);};q.NewFromSeq=function(bT){var bU,bV,bW;bU={};bV=V.Get(bT);try{while(bV.MoveNext()){bW=bV.Current();bU[bW[0]]=bW[1];}}finally{if(typeof bV=="object"&&"Dispose"in bV)bV.Dispose();}return bU;};h.New=function(bT,bU,bV){return{id:bT,view:bU,render:bV};};r=j.Doc=bQ.Class({},i,r);r.Append=function(bT,bU){return r.Mk({$:0,$0:bT.docNode,$1:bU.docNode},s.Map2Unit(bT.updates,bU.updates));};r.get_Empty=function(){return r.Mk(null,s.Const());};r.RunById=function(bT,bU){var bV;bV=self.document.getElementById(bT);if(I.Equals(bV,null))f.FailWith("invalid id: "+bT);else r.Run(bV,bU);};r.Mk=function(bT,bU){return new r.New(bT,bU);};r.EmbedView=function(bT){var bU;bU=Q.CreateEmbedNode();return r.Mk({$:2,$0:bU},s.Map(a.ignore,s.Bind(function(bV){Q.UpdateEmbedNode(bU,bV.docNode);return bV.updates;},bT)));};r.TextNode=function(bT){return r.Mk({$:5,$0:self.document.createTextNode(bT)},s.Const());};r.Input=function(bT,bU){return r.InputInternal("input",function(){return G.append(bT,[T.Value(bU)]);});};r.Concat=function(bT){var bU;bU=U.ofSeqNonCopying(bT);return U.TreeReduce(r.get_Empty(),r.Append,bU);};r.EmailInput=function(bT,bU){return r.InputInternal("input",function(){return G.append(bT,[T.Value(bU),F.Create("type","email")]);});};r.Button=function(bT,bU,bV){var bW;bW=F.Concat(bU);return _6.New(r.Clickable("button",bV),bW,r.TextNode(bT));};r.Run=function(bT,bU){Q.LinkElement(bT,bU.docNode);r.RunInPlace(false,bT,bU);};r.Element=function(bT,bU,bV){var bW,bX;bW=F.Concat(bU);bX=r.Concat(bV);return _6.New(self.document.createElement(bT),bW,bX);};r.InputInternal=function(bT,bU){var bV;bV=self.document.createElement(bT);return _6.New(bV,F.Concat(bU(bV)),r.get_Empty());};r.Clickable=function(bT,bU){var bV;bV=self.document.createElement(bT);bV.addEventListener("click",function(bW){bW.preventDefault();return bU();},false);return bV;};r.BindView=function(bT,bU){return r.EmbedView(s.Map(bT,bU));};r.RunInPlace=function(bT,bU,bV){var bW;bW=Q.CreateRunState(bU,bV.docNode);s.Sink(bb.get_UseAnimations()||bc.BatchUpdatesEnabled()?bd.StartProcessor(Q.PerformAnimatedUpdate(bT,bW,bV.docNode)):function(){Q.PerformSyncUpdate(bT,bW,bV.docNode);},bV.updates);};r.New=bQ.Ctor(function(bT,bU){i.New.call(this);this.docNode=bT;this.updates=bU;},r);s.Map=function(bT,bU){return s.CreateLazy(function(){return E.Map(bT,bU());});};s.Map2Unit=function(bT,bU){return s.CreateLazy(function(){return E.Map2Unit(bT(),bU());});};s.CreateLazy=function(bT){var bU;bU={c:null,o:bT};return function(){var bV,bW;bV=bU.c;return bV===null?(bV=bU.o(),bU.c=bV,(bW=bV.s,bW!=null&&bW.$==0)?bU.o=null:E.WhenObsoleteRun(bV,function(){bU.c=null;}),bV):bV;};};s.Const=function(bT){var bU;bU=E.New({$:0,$0:bT});return function(){return bU;};};s.Bind=function(bT,bU){return s.Join(s.Map(bT,bU));};s.Map2=function(bT,bU,bV){return s.CreateLazy(function(){return E.Map2(bT,bU(),bV());});};s.Join=function(bT){return s.CreateLazy(function(){return E.Join(bT());});};s.Sink=function(bT,bU){function bV(){E.WhenRun(bU(),bT,function(){bn.scheduler().Fork(bV);});}bn.scheduler().Fork(bV);};s.SnapshotOn=function(bT,bU,bV){var bW;bW=E.New({$:2,$0:bT,$1:[]});return s.CreateLazy(function(){return bW.s==null?E.SnapshotOn(bU(),bV()):(E.WhenObsolete(bU(),bW),bW);});};u=t.attr=bQ.Class({},i,u);v.Through$1=function(bT,bU){return s.Map(function(bV){return bV.$==1?{$:1,$0:l.filter(function(bW){return bW.id==bU.get_Id();},bV.$0)}:bV;},bT);};w=j.Submitter=bQ.Class({Trigger:function(){this["var"].Set(null);}},i,w);w.New=bQ.Ctor(function(bT,bU){i.New.call(this);this.input=bT;this["var"]=D.Create();this.view=s.SnapshotOn(bU,this["var"].get_View(),this.input);},w);x.toSafe=function(bT){return bT==null?"":bT;};z.LoadLocalTemplates=function(bT){!z.LocalTemplatesLoaded()?(z.set_LocalTemplatesLoaded(true),z.LoadNestedTemplates(self.document.body,"")):void 0;z.LoadedTemplates().set_Item(bT,z.LoadedTemplateFile(""));};z.LocalTemplatesLoaded=function(){Y.$cctor();return Y.LocalTemplatesLoaded;};z.set_LocalTemplatesLoaded=function(bT){Y.$cctor();Y.LocalTemplatesLoaded=bT;};z.LoadNestedTemplates=function(bT,bU){var bW,bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b_,b$,ca,cb,cc,cd,ce;function bV(cf){var cg,ch;if(!bW.ContainsKey(cf)){cg=(ch=null,[bX.TryGetValue(cf,{get:function(){return ch;},set:function(ci){ch=ci;}}),ch]);if(cg[0]){ce.SAdd(cf);bX.RemoveKey(cf);z.PrepareTemplateStrict(bU,{$:1,$0:cf},cg[1],{$:1,$0:bV});}else bR.warn(ce.Contains(cf)?"Encountered loop when instantiating "+cf:"Local template does not exist: "+cf);}}bW=z.LoadedTemplateFile(bU);bX=new M.New$5();bY=bT.querySelectorAll("[ws-template]");for(bZ=0,b0=bY.length-1;bZ<=b0;bZ++){b1=bY[bZ];b2=b1.getAttribute("ws-template").toLowerCase();b1.removeAttribute("ws-template");bX.set_Item(b2,z.FakeRootSingle(b1));}b3=bT.querySelectorAll("[ws-children-template]");for(b4=0,b5=b3.length-1;b4<=b5;b4++){b6=b3[b4];b7=b6.getAttribute("ws-children-template").toLowerCase();b6.removeAttribute("ws-children-template");bX.set_Item(b7,z.FakeRoot(b6));}b8=bT.querySelectorAll("template[id]");for(b9=0,b_=b8.length-1;b9<=b_;b9++){b$=b8[b9];bX.set_Item(b$.getAttribute("id").toLowerCase(),z.FakeRootFromHTMLTemplate(b$));}ca=bT.querySelectorAll("template[name]");for(cb=0,cc=ca.length-1;cb<=cc;cb++){cd=ca[cb];bX.set_Item(cd.getAttribute("name").toLowerCase(),z.FakeRootFromHTMLTemplate(cd));}ce=new Z.New$3();while(bX.count>0)bV(G.head(bX.Keys()));};z.LoadedTemplates=function(){Y.$cctor();return Y.LoadedTemplates;};z.LoadedTemplateFile=function(bT){var bU,bV,bW;bU=(bV=null,[z.LoadedTemplates().TryGetValue(bT,{get:function(){return bV;},set:function(bX){bV=bX;}}),bV]);return bU[0]?bU[1]:(bW=new M.New$5(),(z.LoadedTemplates().set_Item(bT,bW),bW));};z.FakeRootSingle=function(bT){var bU,bV,bW,bX;bT.removeAttribute("ws-template");bU=bT.getAttribute("ws-replace");if(bU==null);else{bT.removeAttribute("ws-replace");bV=bT.parentNode;I.Equals(bV,null)?void 0:(bW=self.document.createElement(bT.tagName),bW.setAttribute("ws-replace",bU),bV.replaceChild(bW,bT));}bX=self.document.createElement("div");bX.appendChild(bT);return bX;};z.FakeRoot=function(bT){var bU;bU=self.document.createElement("div");while(bT.hasChildNodes())bU.appendChild(bT.firstChild);return bU;};z.FakeRootFromHTMLTemplate=function(bT){var bU,bV,bW,bX;bU=self.document.createElement("div");bV=bT.content;for(bW=0,bX=bV.childNodes.length-1;bW<=bX;bW++)bU.appendChild(bV.childNodes[bW].cloneNode(true));return bU;};z.PrepareTemplateStrict=function(bT,bU,bV,bW){var bX,bY;function bZ(b5,b6){var b7,b8,b9,b_,b$,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv;function ca(cw){}while(true)switch(b5){case 0:if(b6!==null){b7=b6.nextSibling;if(I.Equals(b6.nodeType,K.TEXT_NODE))_9.convertTextNode(b6);else if(I.Equals(b6.nodeType,K.ELEMENT_NODE))b1(b6);b6=b7;}else return null;break;case 1:cb=_.string(b6.nodeName,{$:1,$0:3},null).toLowerCase();cc=(b8=cb.indexOf("."),b8===-1?[bT,cb]:[_.string(cb,null,{$:1,$0:b8-1}),_.string(cb,{$:1,$0:b8+1},null)]);cd=cc[1];ce=cc[0];if(ce!=""&&!z.LoadedTemplates().ContainsKey(ce))return _9.failNotLoaded(cd);else{if(ce==""&&bW!=null)bW.$0(cd);cf=z.LoadedTemplates().Item(ce);if(!cf.ContainsKey(cd))return _9.failNotLoaded(cd);else{cg=cf.Item(cd);ch=cg.cloneNode(true);ci=new Z.New$3();cj=new M.New$5();ck=b6.attributes;for(cl=0,cm=ck.length-1;cl<=cm;cl++){cn=ck.item(cl).name.toLowerCase();cj.set_Item(cn,(co=ck.item(cl).nodeValue,co==""?cn:co.toLowerCase()));if(!ci.SAdd(cn))bR.warn("Hole mapped twice",cn);}for(cp=0,cq=b6.childNodes.length-1;cp<=cq;cp++){cr=b6.childNodes[cp];if(I.Equals(cr.nodeType,K.ELEMENT_NODE))!ci.SAdd(cr.nodeName.toLowerCase())?bR.warn("Hole filled twice",cd):void 0;}cs=b6.childNodes.length===1&&I.Equals(b6.firstChild.nodeType,K.TEXT_NODE);if(cs){b_=_9.fillTextHole(ch,b6.firstChild.textContent,cd);((function(cw){return function(cx){if(cx!=null)cw(cx.$0);};}((b$=function(cw){return function(cx){return cw.SAdd(cx);};}(ci),function(cw){return ca(b$(cw));})))(b_));}_9.removeHolesExcept(ch,ci);if(!cs){for(ct=0,cu=b6.childNodes.length-1;ct<=cu;ct++){cv=b6.childNodes[ct];if(I.Equals(cv.nodeType,K.ELEMENT_NODE))cv.hasAttributes()?_9.fillInstanceAttrs(ch,cv):b0(ch,cv);}}_9.mapHoles(ch,cj);_9.fill(ch,b6.parentNode,b6);b6.parentNode.removeChild(b6);return;}}break;}}function b0(b5,b6){var b7,b8,b_,b$;function b9(ca,cb){var cc;if(b_=="title"&&b6.hasChildNodes()){cc=S.ParseHTMLIntoFakeRoot(b6.textContent);b6.removeChild(b6.firstChild);while(cc.hasChildNodes())b6.appendChild(cc.firstChild);}else null;b1(b6);return _9.fill(b6,ca,cb);}b_=b6.nodeName.toLowerCase();z.foreachNotPreserved(b5,"[ws-attr-holes]",function(ca){var cb,cc,cd,ce,cf;cb=bj.SplitChars(ca.getAttribute("ws-attr-holes"),[" "],1);for(cc=0,cd=cb.length-1;cc<=cd;cc++){ce=X.get(cb,cc);ca.setAttribute(ce,(cf=new a.RegExp("\\${"+b_+"}","ig"),ca.getAttribute(ce).replace(cf,b6.textContent)));}});b$=b5.querySelector("[ws-hole="+b_+"]");if(I.Equals(b$,null)){b7=b5.querySelector("[ws-replace="+b_+"]");return I.Equals(b7,null)?(b8=b5.querySelector("slot[name="+b_+"]"),b5.tagName.toLowerCase()=="template"?(b9(b8.parentNode,b8),void b8.parentNode.removeChild(b8)):null):(b9(b7.parentNode,b7),void b7.parentNode.removeChild(b7));}else{while(b$.hasChildNodes())b$.removeChild(b$.lastChild);b$.removeAttribute("ws-hole");return b9(b$,null);}}function b1(b5){if(!b5.hasAttribute("ws-preserve"))if(bj.StartsWith(b5.nodeName.toLowerCase(),"ws-"))b3(b5);else{_9.convertAttrs(b5);b2(b5.firstChild);}}function b2(b5){return bZ(0,b5);}function b3(b5){return bZ(1,b5);}function b4(b5){var b6,b7,b8,b9,b_,b$,ca,cb,cc,cd,ce,cf;while(true){b6=b5.querySelector("[ws-template]");if(I.Equals(b6,null)){b7=b5.querySelector("[ws-children-template]");if(I.Equals(b7,null)){b8=b5.querySelectorAll("template[id]");for(b9=1,b_=b8.length-1;b9<=b_;b9++){b$=b8[b9];if(bX.Contains(b$));else{z.PrepareTemplateStrict(bT,{$:1,$0:b$.getAttribute("id")},b$,null);bX.SAdd(b$);}}ca=b5.querySelectorAll("template[name]");for(cb=1,cc=ca.length-1;cb<=cc;cb++){cd=ca[cb];if(bX.Contains(cd));else{z.PrepareTemplateStrict(bT,{$:1,$0:cd.getAttribute("name")},cd,null);bX.SAdd(cd);}}return null;}else{ce=b7.getAttribute("ws-children-template");b7.removeAttribute("ws-children-template");z.PrepareTemplateStrict(bT,{$:1,$0:ce},b7,null);b5=b5;}}else{cf=b6.getAttribute("ws-template");(z.PrepareSingleTemplate(bT,{$:1,$0:cf},b6))(null);b5=b5;}}}bX=new Z.New$3();bY=(bU==null?"":bU.$0).toLowerCase();z.LoadedTemplateFile(bT).set_Item(bY,bV);if(bV.hasChildNodes()){b4(bV);b2(bV.firstChild);}};z.foreachNotPreserved=function(bT,bU,bV){S.IterSelector(bT,bU,function(bW){if(bW.closest("[ws-preserve]")==null)bV(bW);});};z.PrepareSingleTemplate=function(bT,bU,bV){var bW;bW=z.FakeRootSingle(bV);return function(bX){z.PrepareTemplateStrict(bT,bU,bW,bX);};};z.TextHoleRE=function(){Y.$cctor();return Y.TextHoleRE;};A.op_LessMultiplyGreater=function(bT,bU){return h.Apply(bT,bU);};B.IsNotEmpty=function(bT,bU){return B.Is(function(bV){return bV!="";},bT,bU);};B.IsMatch=function(bT,bU,bV){var bW;return B.Is((bW=new a.RegExp(bT),function(bX){return bW.test(bX);}),bU,bV);};B.Is=function(bT,bU,bV){return h.MapResult(function(bW){return bW.$==1?bW:bT(bW.$0)?bW:{$:1,$0:l.ofArray([new H.New(bV.id,bU)])};},bV);};C.Map=function(bT,bU){return bU.$==1?{$:1,$0:bU.$0}:{$:0,$0:bT(bU.$0)};};C.Apply=function(bT,bU){return bT.$==0?bU.$==0?{$:0,$0:bT.$0(bU.$0)}:{$:1,$0:bU.$0}:bU.$==0?{$:1,$0:bT.$0}:{$:1,$0:l.append(bT.$0,bU.$0)};};D=j.Var$1=bQ.Class({},i,D);D.Create$1=function(bT){return new P.New(false,E.New({$:2,$0:bT,$1:[]}),bT);};D.Create=function(){return new P.New(false,E.New({$:2,$0:null,$1:[]}),null);};s=j.View=bQ.Class({},null,s);E.Map=function(bT,bU){var bV,bW;bV=bU.s;return bV!=null&&bV.$==0?E.New({$:0,$0:bT(bV.$0)}):(bW=E.New({$:3,$0:[],$1:[]}),(E.When(bU,function(bX){E.MarkDone(bW,bU,bT(bX));},bW),bW));};E.Map2Unit=function(bT,bU){var bV,bW,bX;function bY(){var bZ,b0,b1;if(!(bZ=bX.s,bZ!=null&&bZ.$==0||bZ!=null&&bZ.$==2)){b0=E.ValueAndForever(bT);b1=E.ValueAndForever(bU);if(b0!=null&&b0.$==1)b1!=null&&b1.$==1?b0.$0[1]&&b1.$0[1]?E.MarkForever(bX,null):E.MarkReady(bX,null):void 0;}}bV=bT.s;bW=bU.s;return bV!=null&&bV.$==0?bW!=null&&bW.$==0?E.New({$:0,$0:null}):bU:bW!=null&&bW.$==0?bT:(bX=E.New({$:3,$0:[],$1:[]}),(E.When(bT,bY,bX),E.When(bU,bY,bX),bX));};E.WhenObsoleteRun=function(bT,bU){var bV;bV=bT.s;if(bV==null)bU();else bV!=null&&bV.$==2?bV.$1.push(bU):bV!=null&&bV.$==3?bV.$1.push(bU):void 0;};E.When=function(bT,bU,bV){var bW;bW=bT.s;if(bW==null)E.Obsolete(bV);else bW!=null&&bW.$==2?(E.EnqueueSafe(bW.$1,bV),bU(bW.$0)):bW!=null&&bW.$==3?(bW.$0.push(bU),E.EnqueueSafe(bW.$1,bV)):bU(bW.$0);};E.MarkDone=function(bT,bU,bV){var bW;if(bW=bU.s,bW!=null&&bW.$==0)E.MarkForever(bT,bV);else E.MarkReady(bT,bV);};E.ValueAndForever=function(bT){var bU;bU=bT.s;return bU!=null&&bU.$==0?{$:1,$0:[bU.$0,true]}:bU!=null&&bU.$==2?{$:1,$0:[bU.$0,false]}:null;};E.MarkForever=function(bT,bU){var bV,bW,bX,bY;bV=bT.s;if(bV!=null&&bV.$==3){bT.s={$:0,$0:bU};bW=bV.$0;for(bX=0,bY=X.length(bW)-1;bX<=bY;bX++)(X.get(bW,bX))(bU);}else void 0;};E.MarkReady=function(bT,bU){var bV,bW,bX,bY;bV=bT.s;if(bV!=null&&bV.$==3){bT.s={$:2,$0:bU,$1:bV.$1};bW=bV.$0;for(bX=0,bY=X.length(bW)-1;bX<=bY;bX++)(X.get(bW,bX))(bU);}else void 0;};E.EnqueueSafe=function(bT,bU){var bV,bW,bX,bY;bT.push(bU);if(bT.length%20===0){bV=bT.slice(0);br.Clear(bT);for(bW=0,bX=X.length(bV)-1;bW<=bX;bW++){bY=X.get(bV,bW);if(typeof bY=="object")(function(bZ){if(bZ.s)bT.push(bZ);}(bY));else(function(bZ){bT.push(bZ);}(bY));}}else void 0;};E.Map2=function(bT,bU,bV){var bW,bX,bY;function bZ(b0){var b1,b2,b3;if(!(b1=bY.s,b1!=null&&b1.$==0||b1!=null&&b1.$==2)){b2=E.ValueAndForever(bU);b3=E.ValueAndForever(bV);if(b2!=null&&b2.$==1)b3!=null&&b3.$==1?b2.$0[1]&&b3.$0[1]?E.MarkForever(bY,bT(b2.$0[0],b3.$0[0])):E.MarkReady(bY,bT(b2.$0[0],b3.$0[0])):void 0;}}bW=bU.s;bX=bV.s;return bW!=null&&bW.$==0?bX!=null&&bX.$==0?E.New({$:0,$0:bT(bW.$0,bX.$0)}):E.Map2Opt1(bT,bW.$0,bV):bX!=null&&bX.$==0?E.Map2Opt2(bT,bX.$0,bU):(bY=E.New({$:3,$0:[],$1:[]}),(E.When(bU,bZ,bY),E.When(bV,bZ,bY),bY));};E.Join=function(bT){var bU;bU=E.New({$:3,$0:[],$1:[]});E.When(bT,function(bV){var bW;bW=bV();E.When(bW,function(bX){var bY,bZ;if((bY=bW.s,bY!=null&&bY.$==0)&&(bZ=bT.s,bZ!=null&&bZ.$==0))E.MarkForever(bU,bX);else E.MarkReady(bU,bX);},bU);},bU);return bU;};E.WhenRun=function(bT,bU,bV){var bW;bW=bT.s;if(bW==null)bV();else bW!=null&&bW.$==2?(bW.$1.push(bV),bU(bW.$0)):bW!=null&&bW.$==3?(bW.$0.push(bU),bW.$1.push(bV)):bU(bW.$0);};E.Map2Opt1=function(bT,bU,bV){return E.Map(function(bW){return bT(bU,bW);},bV);};E.Map2Opt2=function(bT,bU,bV){return E.Map(function(bW){return bT(bW,bU);},bV);};E.SnapshotOn=function(bT,bU){var bV;function bW(bX){var bY,bZ,b0;if(!(bY=bV.s,bY!=null&&bY.$==0||bY!=null&&bY.$==2)){bZ=E.ValueAndForever(bT);b0=E.ValueAndForever(bU);if(bZ!=null&&bZ.$==1)b0!=null&&b0.$==1?bZ.$0[1]||b0.$0[1]?E.MarkForever(bV,b0.$0[0]):E.MarkReady(bV,b0.$0[0]):void 0;}}bV=E.New({$:3,$0:[],$1:[]});E.When(bT,bW,bV);E.WhenReady(bU,bW);return bV;};E.WhenObsolete=function(bT,bU){var bV;bV=bT.s;if(bV==null)E.Obsolete(bU);else bV!=null&&bV.$==2?E.EnqueueSafe(bV.$1,bU):bV!=null&&bV.$==3?E.EnqueueSafe(bV.$1,bU):void 0;};E.Copy=function(bT){var bU,bV,bW;bU=bT.s;return bU==null?bT:bU!=null&&bU.$==2?(bV=E.New({$:2,$0:bU.$0,$1:[]}),(E.WhenObsolete(bT,bV),bV)):bU!=null&&bU.$==3?(bW=E.New({$:3,$0:[],$1:[]}),(E.When(bT,function(bX){E.MarkDone(bW,bT,bX);},bW),bW)):bT;};E.WhenReady=function(bT,bU){var bV,bW;bW=bT.s;switch(bW!=null&&bW.$==2?(bV=bW.$0,0):bW==null?1:bW!=null&&bW.$==3?2:(bV=bW.$0,0)){case 0:bU(bV);break;case 1:null;break;case 2:bW.$0.push(bU);break;}};F=j.AttrProxy=bQ.Class({},null,F);F.Create=function(bT,bU){return R.Static(function(bV){bV.setAttribute(bT,bU);});};F.Concat=function(bT){var bU;bU=U.ofSeqNonCopying(bT);return U.TreeReduce(R.EmptyAttr(),F.Append,bU);};F.Append=function(bT,bU){return R.AppendTree(bT,bU);};G.delay=function(bT){return{GetEnumerator:function(){return V.Get(bT());}};};G.map=function(bT,bU){return{GetEnumerator:function(){var bV;bV=V.Get(bU);return new W.New(null,null,function(bW){return bV.MoveNext()&&(bW.c=bT(bV.Current()),true);},function(){bV.Dispose();});}};};G.choose=function(bT,bU){return G.collect(function(bV){var bW;bW=bT(bV);return bW==null?m.Empty:l.ofArray([bW.$0]);},bU);};G.append=function(bT,bU){return{GetEnumerator:function(){var bV,bW;bV=V.Get(bT);bW=[true];return new W.New(bV,null,function(bX){var bY;return bX.s.MoveNext()?(bX.c=bX.s.Current(),true):(bY=bX.s,!I.Equals(bY,null)?bY.Dispose():void 0,bX.s=null,bW[0]&&(bW[0]=false,bX.s=V.Get(bU),bX.s.MoveNext()?(bX.c=bX.s.Current(),true):(bX.s.Dispose(),bX.s=null,false)));},function(bX){var bY;bY=bX.s;if(!I.Equals(bY,null))bY.Dispose();});}};};G.collect=function(bT,bU){return G.concat(G.map(bT,bU));};G.head=function(bT){var bU;bU=V.Get(bT);try{return bU.MoveNext()?bU.Current():G.insufficient();}finally{if(typeof bU=="object"&&"Dispose"in bU)bU.Dispose();}};G.concat=function(bT){return{GetEnumerator:function(){var bU;function bV(bW){var bX;while(true){bX=bW.s;if(I.Equals(bX,null)){if(bU.MoveNext()){bW.s=V.Get(bU.Current());bW=bW;}else{bU.Dispose();return false;}}else if(bX.MoveNext()){bW.c=bX.Current();return true;}else{bW.Dispose();bW.s=null;bW=bW;}}}bU=V.Get(bT);return new W.New(null,null,bV,function(bW){var bX;bX=bW.s;if(!I.Equals(bX,null))bX.Dispose();if(!I.Equals(bU,null))bU.Dispose();});}};};G.fold=function(bT,bU,bV){var bW,bX;bW=bU;bX=V.Get(bV);try{while(bX.MoveNext())bW=bT(bW,bX.Current());return bW;}finally{if(typeof bX=="object"&&"Dispose"in bX)bX.Dispose();}};G.init=function(bT,bU){return G.take(bT,G.initInfinite(bU));};G.iter=function(bT,bU){var bV;bV=V.Get(bU);try{while(bV.MoveNext())bT(bV.Current());}finally{if(typeof bV=="object"&&"Dispose"in bV)bV.Dispose();}};G.forall=function(bT,bU){return!G.exists(function(bV){return!bT(bV);},bU);};G.take=function(bT,bU){bT<0?G.nonNegative():void 0;return{GetEnumerator:function(){var bV;bV=[V.Get(bU)];return new W.New(0,null,function(bW){var bX;bW.s=bW.s+1;return bW.s>bT?false:(bX=bV[0],I.Equals(bX,null)?G.insufficient():bX.MoveNext()?(bW.c=bX.Current(),bW.s===bT?(bX.Dispose(),bV[0]=null):void 0,true):(bX.Dispose(),bV[0]=null,G.insufficient()));},function(){var bW;bW=bV[0];if(!I.Equals(bW,null))bW.Dispose();});}};};G.initInfinite=function(bT){return{GetEnumerator:function(){return new W.New(0,null,function(bU){bU.c=bT(bU.s);bU.s=bU.s+1;return true;},void 0);}};};G.max=function(bT){var bU,bV,bW;bU=V.Get(bT);try{if(!bU.MoveNext())G.seqEmpty();bV=bU.Current();while(bU.MoveNext()){bW=bU.Current();if(I.Compare(bW,bV)===1)bV=bW;}return bV;}finally{if(typeof bU=="object"&&"Dispose"in bU)bU.Dispose();}};G.exists=function(bT,bU){var bV,bW;bV=V.Get(bU);try{bW=false;while(!bW&&bV.MoveNext())bW=bT(bV.Current());return bW;}finally{if(typeof bV=="object"&&"Dispose"in bV)bV.Dispose();}};G.seqEmpty=function(){return f.FailWith("The input sequence was empty.");};H=g.ErrorMessage=bQ.Class({},i,H);H.New=bQ.Ctor(function(bT,bU){i.New.call(this);this.id=bT;this.message=bU;},H);I.Equals=function(bT,bU){var bV,bW,bX,bY;if(bT===bU)return true;else{bV=typeof bT;if(bV=="object"){if(bT===null||bT===void 0||bU===null||bU===void 0||!I.Equals(typeof bU,"object"))return false;else if("Equals"in bT)return bT.Equals(bU);else if("Equals"in bU)return false;else if(bT instanceof a.Array&&bU instanceof a.Array)return I.arrayEquals(bT,bU);else if(bT instanceof a.Date&&bU instanceof a.Date)return I.dateEquals(bT,bU);else{bW=[true];for(var bZ in bT)if(function(b0){bW[0]=!bT.hasOwnProperty(b0)||bU.hasOwnProperty(b0)&&I.Equals(bT[b0],bU[b0]);return!bW[0];}(bZ))break;if(bW[0]){for(var b0 in bU)if(function(b1){bW[0]=!bU.hasOwnProperty(b1)||bT.hasOwnProperty(b1);return!bW[0];}(b0))break;}return bW[0];}}else return bV=="function"&&("$Func"in bT?bT.$Func===bU.$Func&&bT.$Target===bU.$Target:"$Invokes"in bT&&"$Invokes"in bU&&I.arrayEquals(bT.$Invokes,bU.$Invokes));}};I.arrayEquals=function(bT,bU){var bV,bW;if(X.length(bT)===X.length(bU)){bV=true;bW=0;while(bV&&bW<X.length(bT)){!I.Equals(X.get(bT,bW),X.get(bU,bW))?bV=false:void 0;bW=bW+1;}return bV;}else return false;};I.dateEquals=function(bT,bU){return bT.getTime()===bU.getTime();};I.Hash=function(bT){var bU;bU=typeof bT;return bU=="function"?0:bU=="boolean"?bT?1:0:bU=="number"?bT:bU=="string"?I.hashString(bT):bU=="object"?bT==null?0:bT instanceof a.Array?I.hashArray(bT):I.hashObject(bT):0;};I.hashString=function(bT){var bU,bV,bW;if(bT===null)return 0;else{bU=5381;for(bV=0,bW=bT.length-1;bV<=bW;bV++)bU=I.hashMix(bU,bT[bV].charCodeAt());return bU;}};I.hashArray=function(bT){var bU,bV,bW;bU=-34948909;for(bV=0,bW=X.length(bT)-1;bV<=bW;bV++)bU=I.hashMix(bU,I.Hash(X.get(bT,bV)));return bU;};I.hashObject=function(bT){var bU,bV;if("GetHashCode"in bT)return bT.GetHashCode();else{bU=[0];for(var bW in bT)if(function(bX){bU[0]=I.hashMix(I.hashMix(bU[0],I.hashString(bX)),I.Hash(bT[bX]));return false;}(bW))break;return bU[0];}};I.hashMix=function(bT,bU){return(bT<<5)+bT+bU;};I.Compare=function(bT,bU){var bV,bW,bX,bY,bZ,b0;if(bT===bU)return 0;else{bW=typeof bT;switch(bW=="function"?1:bW=="boolean"?2:bW=="number"?2:bW=="string"?2:bW=="object"?3:0){case 0:return typeof bU=="undefined"?0:-1;case 1:return f.FailWith("Cannot compare function values.");case 2:return bT<bU?-1:1;case 3:if(bT===null)bX=-1;else if(bU===null)bX=1;else if("CompareTo"in bT)bX=bT.CompareTo(bU);else if("CompareTo0"in bT)bX=bT.CompareTo0(bU);else if(bT instanceof a.Array&&bU instanceof a.Array)bX=I.compareArrays(bT,bU);else if(bT instanceof a.Date&&bU instanceof a.Date)bX=I.compareDates(bT,bU);else{bY=[0];for(var b1 in bT)if(function(b2){return!bT.hasOwnProperty(b2)?false:!bU.hasOwnProperty(b2)?(bY[0]=1,true):(bY[0]=I.Compare(bT[b2],bU[b2]),bY[0]!==0);}(b1))break;if(bY[0]===0){for(var b2 in bU)if(function(b3){return!bU.hasOwnProperty(b3)?false:!bT.hasOwnProperty(b3)&&(bY[0]=-1,true);}(b2))break;}bX=bY[0];}return bX;}}};I.compareArrays=function(bT,bU){var bV,bW;if(X.length(bT)<X.length(bU))return -1;else if(X.length(bT)>X.length(bU))return 1;else{bV=0;bW=0;while(bV===0&&bW<X.length(bT)){bV=I.Compare(X.get(bT,bW),X.get(bU,bW));bW=bW+1;}return bV;}};I.compareDates=function(bT,bU){return I.Compare(bT.getTime(),bU.getTime());};M=L.Dictionary=bQ.Class({set_Item:function(bT,bU){this.set(bT,bU);},ContainsKey:function(bT){var bU,bV;bU=this;bV=this.data[this.hash(bT)];return bV==null?false:X.exists(function(bW){return bU.equals.apply(null,[(f.KeyValue(bW))[0],bT]);},bV);},TryGetValue:function(bT,bU){var bV,bW,bX;bV=this;bW=this.data[this.hash(bT)];return bW==null?false:(bX=X.tryPick(function(bY){var bZ;bZ=f.KeyValue(bY);return bV.equals.apply(null,[bZ[0],bT])?{$:1,$0:bZ[1]}:null;},bW),bX!=null&&bX.$==1&&(bU.set(bX.$0),true));},RemoveKey:function(bT){return this.remove(bT);},Keys:function(){return new $.New(this);},set:function(bT,bU){var bV,bW,bX,bY;bV=this;bW=this.hash(bT);bX=this.data[bW];if(bX==null){this.count=this.count+1;this.data[bW]=new a.Array({K:bT,V:bU});}else{bY=X.tryFindIndex(function(bZ){return bV.equals.apply(null,[(f.KeyValue(bZ))[0],bT]);},bX);bY==null?(this.count=this.count+1,bX.push({K:bT,V:bU})):bX[bY.$0]={K:bT,V:bU};}},remove:function(bT){var bU,bV,bW,bX;bU=this;bV=this.hash(bT);bW=this.data[bV];return bW==null?false:(bX=X.filter(function(bY){return!bU.equals.apply(null,[(f.KeyValue(bY))[0],bT]);},bW),X.length(bX)<bW.length&&(this.count=this.count-1,this.data[bV]=bX,true));},Item:function(bT){return this.get(bT);},get:function(bT){var bU,bV;bU=this;bV=this.data[this.hash(bT)];return bV==null?_7.notPresent():X.pick(function(bW){var bX;bX=f.KeyValue(bW);return bU.equals.apply(null,[bX[0],bT])?{$:1,$0:bX[1]}:null;},bV);},GetEnumerator:function(){return V.Get0(X.concat(o.GetFieldValues(this.data)));}},i,M);M.New$5=bQ.Ctor(function(){M.New$6.call(this,[],I.Equals,I.Hash);},M);M.New$6=bQ.Ctor(function(bT,bU,bV){var bW,bX;i.New.call(this);this.equals=bU;this.hash=bV;this.count=0;this.data=[];bW=V.Get(bT);try{while(bW.MoveNext()){bX=bW.Current();this.set(bX.K,bX.V);}}finally{if(typeof bW=="object"&&"Dispose"in bW)bW.Dispose();}},M);N.Id=function(){(N.lastId())[0]++;return"Form"+a.String((N.lastId())[0]);};N.lastId=function(){be.$cctor();return be.lastId;};P=j.ConcreteVar=bQ.Class({Get:function(){return this.current;},Set:function(bT){if(this.isConst)(function(bU){return bU("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(bU){bR.log(bU);}));else{E.Obsolete(this.snap);this.current=bT;this.snap=E.New({$:2,$0:bT,$1:[]});}},get_View:function(){return this.view;},get_Id:function(){return"uinref"+a.String(this.id);},UpdateMaybe:function(bT){var bU;bU=bT(this.Get());if(bU!=null&&bU.$==1)this.Set(bU.$0);}},k,P);P.New=bQ.Ctor(function(bT,bU,bV){var bW;bW=this;k.New.call(this);this.isConst=bT;this.current=bV;this.snap=bU;this.view=function(){return bW.snap;};this.id=_2.Int();},P);E.Obsolete=function(bT){var bU,bV,bW,bX,bY;bV=bT.s;if(bV==null||(bV!=null&&bV.$==2?(bU=bV.$1,false):bV!=null&&bV.$==3?(bU=bV.$1,false):true))void 0;else{bT.s=null;for(bW=0,bX=X.length(bU)-1;bW<=bX;bW++){bY=X.get(bU,bW);if(typeof bY=="object")(function(bZ){E.Obsolete(bZ);}(bY));else bY();}}};E.New=function(bT){return{s:bT};};Q.CreateEmbedNode=function(){return{Current:null,Dirty:false};};Q.UpdateEmbedNode=function(bT,bU){bT.Current=bU;bT.Dirty=true;};Q.LinkElement=function(bT,bU){Q.InsertDoc(bT,bU,null);};Q.InsertDoc=function(bT,bU,bV){var bW,bX,bY;while(true)if(bU!=null&&bU.$==1)return Q.InsertNode(bT,bU.$0.El,bV);else if(bU!=null&&bU.$==2){bW=bU.$0;bW.Dirty=false;bU=bW.Current;}else if(bU==null)return bV;else if(bU!=null&&bU.$==4)return Q.InsertNode(bT,bU.$0.Text,bV);else if(bU!=null&&bU.$==5)return Q.InsertNode(bT,bU.$0,bV);else if(bU!=null&&bU.$==6)return X.foldBack(function(bZ,b0){return(((bQ.Curried3(function(b1,b2,b3){return b2==null||b2.constructor===O?Q.InsertDoc(b1,b2,b3):Q.InsertNode(b1,b2,b3);}))(bT))(bZ))(b0);},bU.$0.Els,bV);else{bX=bU.$1;bY=bU.$0;bU=bY;bV=Q.InsertDoc(bT,bX,bV);}};Q.CreateRunState=function(bT,bU){return bl.New(bm.get_Empty(),Q.CreateElemNode(bT,R.EmptyAttr(),bU));};Q.PerformAnimatedUpdate=function(bT,bU,bV){var bW;return bb.get_UseAnimations()?(bW=null,bn.Delay(function(){var bX,bY,bZ;bX=bm.FindAll(bV);bY=Q.ComputeChangeAnim(bU,bX);bZ=Q.ComputeEnterAnim(bU,bX);return bn.Bind(bb.Play(bb.Append(bY,Q.ComputeExitAnim(bU,bX))),function(){return bn.Bind(Q.SyncElemNodesNextFrame(bT,bU),function(){return bn.Bind(bb.Play(bZ),function(){bU.PreviousNodes=bX;return bn.Return(null);});});});})):Q.SyncElemNodesNextFrame(bT,bU);};Q.PerformSyncUpdate=function(bT,bU,bV){var bW;bW=bm.FindAll(bV);Q.SyncElemNode(bT,bU.Top);bU.PreviousNodes=bW;};Q.CreateElemNode=function(bT,bU,bV){var bW;Q.LinkElement(bT,bV);bW=R.Insert(bT,bU);return _3.New(bW,bV,null,bT,_2.Int(),bQ.GetOptional(bW.OnAfterRender));};Q.InsertNode=function(bT,bU,bV){S.InsertAt(bT,bV,bU);return bU;};Q.SyncElemNodesNextFrame=function(bT,bU){function bV(bW){a.requestAnimationFrame(function(){Q.SyncElemNode(bT,bU.Top);bW();});}return bc.BatchUpdatesEnabled()?bn.FromContinuations(function(bW,bX,bY){return bV.apply(null,[bW,bX,bY]);}):(Q.SyncElemNode(bT,bU.Top),bn.Return(null));};Q.ComputeExitAnim=function(bT,bU){return bb.Concat(X.map(function(bV){return R.GetExitAnim(bV.Attr);},bm.ToArray(bm.Except(bU,bm.Filter(function(bV){return R.HasExitAnim(bV.Attr);},bT.PreviousNodes)))));};Q.ComputeEnterAnim=function(bT,bU){return bb.Concat(X.map(function(bV){return R.GetEnterAnim(bV.Attr);},bm.ToArray(bm.Except(bT.PreviousNodes,bm.Filter(function(bV){return R.HasEnterAnim(bV.Attr);},bU)))));};Q.ComputeChangeAnim=function(bT,bU){var bV;function bW(bX){return R.HasChangeAnim(bX.Attr);}bV=function(bX){return bm.Filter(bW,bX);};return bb.Concat(X.map(function(bX){return R.GetChangeAnim(bX.Attr);},bm.ToArray(bm.Intersect(bV(bT.PreviousNodes),bV(bU)))));};Q.SyncElemNode=function(bT,bU){!bT?Q.SyncElement(bU):void 0;Q.Sync(bU.Children);Q.AfterRender(bU);};Q.SyncElement=function(bT){function bU(bV){function bW(bX){var bY,bZ,b0,b1;while(true){if(bX!=null&&bX.$==0){bZ=bX.$1;b0=bX.$0;if(bW(b0))return true;else bX=bZ;}else if(bX!=null&&bX.$==2){b1=bX.$0;if(b1.Dirty)return true;else bX=b1.Current;}else return bX!=null&&bX.$==6&&(bY=bX.$0,bY.Dirty||X.exists(bU,bY.Holes));}}return bW(bV.Children);}R.Sync(bT.El,bT.Attr);if(bU(bT))Q.DoSyncElement(bT);};Q.Sync=function(bT){var bU,bV,bW,bX,bY;while(true){if(bT!=null&&bT.$==1)return Q.SyncElemNode(false,bT.$0);else if(bT!=null&&bT.$==2){bW=bT.$0;bT=bW.Current;}else if(bT==null)return null;else if(bT!=null&&bT.$==5)return null;else if(bT!=null&&bT.$==4){bU=bT.$0;return bU.Dirty?(bU.Text.nodeValue=bU.Value,bU.Dirty=false):null;}else if(bT!=null&&bT.$==6){bV=bT.$0;X.iter(function(bZ){Q.SyncElemNode(false,bZ);},bV.Holes);X.iter(function(bZ){R.Sync(bZ[0],bZ[1]);},bV.Attrs);return Q.AfterRender(bV);}else{bX=bT.$1;bY=bT.$0;Q.Sync(bY);bT=bX;}}};Q.AfterRender=function(bT){var bU;bU=bQ.GetOptional(bT.Render);if(bU!=null&&bU.$==1){bU.$0(bT.El);bQ.SetOptional(bT,"Render",null);}};Q.DoSyncElement=function(bT){var bU,bV,bW;function bX(bY,bZ){var b0,b1,b2,b3;while(true){if(bY!=null&&bY.$==1)return bY.$0.El;else if(bY!=null&&bY.$==2){b1=bY.$0;if(b1.Dirty){b1.Dirty=false;return Q.InsertDoc(bU,b1.Current,bZ);}else bY=b1.Current;}else if(bY==null)return bZ;else if(bY!=null&&bY.$==4)return bY.$0.Text;else if(bY!=null&&bY.$==5)return bY.$0;else if(bY!=null&&bY.$==6){b0=bY.$0;b0.Dirty?b0.Dirty=false:void 0;return X.foldBack(function(b4,b5){return b4==null||b4.constructor===O?bX(b4,b5):b4;},b0.Els,bZ);}else{b2=bY.$1;b3=bY.$0;bY=b3;bZ=bX(b2,bZ);}}}bU=bT.El;bK.Iter((bV=bT.El,function(bY){S.RemoveNode(bV,bY);}),bK.Except(bK.DocChildren(bT),bK.Children(bT.El,bQ.GetOptional(bT.Delimiters))));bX(bT.Children,(bW=bQ.GetOptional(bT.Delimiters),bW!=null&&bW.$==1?bW.$0[1]:null));};R.Static=function(bT){return new F({$:3,$0:bT});};R.Updates=function(bT){return U.MapTreeReduce(function(bU){return bU.NChanged();},s.Const(),s.Map2Unit,bT.DynNodes);};R.AppendTree=function(bT,bU){var bV;return bT===null?bU:bU===null?bT:(bV=new F({$:2,$0:bT,$1:bU}),(R.SetFlags(bV,R.Flags(bT)|R.Flags(bU)),bV));};R.EmptyAttr=function(){bh.$cctor();return bh.EmptyAttr;};R.Dynamic=function(bT,bU){return new F({$:1,$0:new by.New(bT,bU)});};R.Insert=function(bT,bU){var bV,bW,bX;function bY(bZ){var b0,b1;while(true)if(!(bZ===null)){if(bZ!=null&&bZ.$==1)return bV.push(bZ.$0);else if(bZ!=null&&bZ.$==2){b0=bZ.$1;b1=bZ.$0;bY(b1);bZ=b0;}else return bZ!=null&&bZ.$==3?bZ.$0(bT):bZ!=null&&bZ.$==4?bW.push(bZ.$0):null;}else return null;}bV=[];bW=[];bY(bU);bX=bV.slice(0);return bg.New(bT,R.Flags(bU),bX,bW.length===0?null:{$:1,$0:function(bZ){G.iter(function(b0){b0(bZ);},bW);}});};R.SetFlags=function(bT,bU){bT.flags=bU;};R.Flags=function(bT){return bT!==null&&bT.hasOwnProperty("flags")?bT.flags:0;};R.HasExitAnim=function(bT){var bU;bU=2;return(bT.DynFlags&bU)===bU;};R.GetExitAnim=function(bT){return R.GetAnim(bT,function(bU,bV){return bU.NGetExitAnim(bV);});};R.HasEnterAnim=function(bT){var bU;bU=1;return(bT.DynFlags&bU)===bU;};R.GetEnterAnim=function(bT){return R.GetAnim(bT,function(bU,bV){return bU.NGetEnterAnim(bV);});};R.HasChangeAnim=function(bT){var bU;bU=4;return(bT.DynFlags&bU)===bU;};R.GetChangeAnim=function(bT){return R.GetAnim(bT,function(bU,bV){return bU.NGetChangeAnim(bV);});};R.GetAnim=function(bT,bU){return bb.Concat(X.map(function(bV){return bU(bV,bT.DynElem);},bT.DynNodes));};R.Sync=function(bT,bU){X.iter(function(bV){bV.NSync(bT);},bU.DynNodes);};S.ParseHTMLIntoFakeRoot=function(bT){var bU,bV,bW,bX,bY;function bZ(b0,b1){var b2;while(true)if(b1===0)return b0;else{b2=b1;b0=b0.lastChild;b1=b2-1;}}bU=self.document.createElement("div");return!S.rhtml().test(bT)?(bU.appendChild(self.document.createTextNode(bT)),bU):(bV=(bW=S.rtagName().exec(bT),I.Equals(bW,null)?"":X.get(bW,1).toLowerCase()),(bX=(bY=(S.wrapMap())[bV],bY?bY:S.defaultWrap()),(bU.innerHTML=bX[1]+bT.replace(S.rxhtmlTag(),"<$1></$2>")+bX[2],bZ(bU,bX[0]))));};S.rhtml=function(){bu.$cctor();return bu.rhtml;};S.wrapMap=function(){bu.$cctor();return bu.wrapMap;};S.defaultWrap=function(){bu.$cctor();return bu.defaultWrap;};S.rxhtmlTag=function(){bu.$cctor();return bu.rxhtmlTag;};S.rtagName=function(){bu.$cctor();return bu.rtagName;};S.IterSelector=function(bT,bU,bV){var bW,bX,bY;bW=bT.querySelectorAll(bU);for(bX=0,bY=bW.length-1;bX<=bY;bX++)bV(bW[bX]);};S.InsertAt=function(bT,bU,bV){var bW;if(!(bV.parentNode===bT&&bU===(bW=bV.nextSibling,I.Equals(bW,null)?null:bW)))bT.insertBefore(bV,bU);};S.RemoveNode=function(bT,bU){if(bU.parentNode===bT)bT.removeChild(bU);};T.Value=function(bT){return T.ValueWith(_5.StringApply(),bT);};T.ValueWith=function(bT,bU){var bV;bV=bT(bU);return F.Append(R.Static(bV[0]),T.DynamicCustom(bV[1],bV[2]));};T.DynamicCustom=function(bT,bU){return R.Dynamic(bU,bT);};U.ofSeqNonCopying=function(bT){var bU,bV;if(bT instanceof a.Array)return bT;else if(bT instanceof m)return X.ofList(bT);else if(bT===null)return[];else{bU=[];bV=V.Get(bT);try{while(bV.MoveNext())bU.push(bV.Current());return bU;}finally{if(typeof bV=="object"&&"Dispose"in bV)bV.Dispose();}}};U.TreeReduce=function(bT,bU,bV){var bW;function bX(bY){return function(bZ){var b0,b1;switch(bZ<=0?0:bZ===1?bY>=0&&bY<bW?1:(b0=bZ,2):(b0=bZ,2)){case 0:return bT;case 1:return X.get(bV,bY);case 2:b1=bZ/2>>0;return bU((bX(bY))(b1),(bX(bY+b1))(bZ-b1));}};}bW=X.length(bV);return(bX(0))(bW);};U.MapTreeReduce=function(bT,bU,bV,bW){var bX;function bY(bZ){return function(b0){var b1,b2;switch(b0<=0?0:b0===1?bZ>=0&&bZ<bX?1:(b1=b0,2):(b1=b0,2)){case 0:return bU;case 1:return bT(X.get(bW,bZ));case 2:b2=b0/2>>0;return bV((bY(bZ))(b2),(bY(bZ+b2))(b0-b2));}};}bX=X.length(bW);return(bY(0))(bX);};V.Get=function(bT){return bT instanceof a.Array?V.ArrayEnumerator(bT):I.Equals(typeof bT,"string")?V.StringEnumerator(bT):bT.GetEnumerator();};V.ArrayEnumerator=function(bT){return new W.New(0,null,function(bU){var bV;bV=bU.s;return bV<X.length(bT)&&(bU.c=X.get(bT,bV),bU.s=bV+1,true);},void 0);};V.StringEnumerator=function(bT){return new W.New(0,null,function(bU){var bV;bV=bU.s;return bV<bT.length&&(bU.c=bT[bV],bU.s=bV+1,true);},void 0);};V.Get0=function(bT){return bT instanceof a.Array?V.ArrayEnumerator(bT):I.Equals(typeof bT,"string")?V.StringEnumerator(bT):"GetEnumerator0"in bT?bT.GetEnumerator0():bT.GetEnumerator();};W=V.T=bQ.Class({Dispose:function(){if(this.d)this.d(this);},MoveNext:function(){var bT;bT=this.n(this);this.e=bT?1:2;return bT;},Current:function(){return this.e===1?this.c:this.e===0?f.FailWith("Enumeration has not started. Call MoveNext."):f.FailWith("Enumeration already finished.");}},i,W);W.New=bQ.Ctor(function(bT,bU,bV,bW){i.New.call(this);this.s=bT;this.c=bU;this.n=bV;this.d=bW;this.e=0;},W);X.get=function(bT,bU){X.checkBounds(bT,bU);return bT[bU];};X.length=function(bT){return bT.dims===2?bT.length*bT.length:bT.length;};X.checkBounds=function(bT,bU){if(bU<0||bU>=bT.length)f.FailWith("Index was outside the bounds of the array.");};X.set=function(bT,bU,bV){X.checkBounds(bT,bU);bT[bU]=bV;};Y.$cctor=function(){Y.$cctor=a.ignore;Y.LoadedTemplates=new M.New$5();Y.LocalTemplatesLoaded=false;Y.GlobalHoles=new M.New$5();Y.TextHoleRE="\\${([^}]+)}";Y.RenderedFullDocTemplate=null;};Z=L.HashSet=bQ.Class({SAdd:function(bT){return this.add(bT);},Contains:function(bT){var bU;bU=this.data[this.hash(bT)];return bU==null?false:this.arrContains(bT,bU);},add:function(bT){var bU,bV;bU=this.hash(bT);bV=this.data[bU];return bV==null?(this.data[bU]=[bT],this.count=this.count+1,true):this.arrContains(bT,bV)?false:(bV.push(bT),this.count=this.count+1,true);},arrContains:function(bT,bU){var bV,bW,bX,bY;bV=true;bW=0;bY=bU.length;while(bV&&bW<bY)if(this.equals.apply(null,[bU[bW],bT]))bV=false;else bW=bW+1;return!bV;},GetEnumerator:function(){return V.Get(bx.concat(this.data));},ExceptWith:function(bT){var bU;bU=V.Get(bT);try{while(bU.MoveNext())this.Remove(bU.Current());}finally{if(typeof bU=="object"&&"Dispose"in bU)bU.Dispose();}},Count:function(){return this.count;},IntersectWith:function(bT){var bU,bV,bW,bX,bY;bU=new Z.New$4(bT,this.equals,this.hash);bV=bx.concat(this.data);for(bW=0,bX=bV.length-1;bW<=bX;bW++){bY=bV[bW];if(!bU.Contains(bY))this.Remove(bY);}},Remove:function(bT){var bU;bU=this.data[this.hash(bT)];return bU==null?false:this.arrRemove(bT,bU)&&(this.count=this.count-1,true);},CopyTo:function(bT,bU){var bV,bW,bX;bV=bx.concat(this.data);for(bW=0,bX=bV.length-1;bW<=bX;bW++)X.set(bT,bW+bU,bV[bW]);},arrRemove:function(bT,bU){var bV,bW,bX,bY;bV=true;bW=0;bY=bU.length;while(bV&&bW<bY)if(this.equals.apply(null,[bU[bW],bT])){bU.splice.apply(bU,[bW,1]);bV=false;}else bW=bW+1;return!bV;}},i,Z);Z.New$3=bQ.Ctor(function(){Z.New$4.call(this,[],I.Equals,I.Hash);},Z);Z.New$4=bQ.Ctor(function(bT,bU,bV){var bW;i.New.call(this);this.equals=bU;this.hash=bV;this.data=[];this.count=0;bW=V.Get(bT);try{while(bW.MoveNext())this.add(bW.Current());}finally{if(typeof bW=="object"&&"Dispose"in bW)bW.Dispose();}},Z);Z.New$2=bQ.Ctor(function(bT){Z.New$4.call(this,bT,I.Equals,I.Hash);},Z);_2.Int=function(){_2.set_counter(_2.counter()+1);return _2.counter();};_2.set_counter=function(bT){bq.$cctor();bq.counter=bT;};_2.counter=function(){bq.$cctor();return bq.counter;};_3=j.DocElemNode=bQ.Class({Equals:function(bT){return this.ElKey===bT.ElKey;},GetHashCode:function(){return this.ElKey;}},null,_3);_3.New=function(bT,bU,bV,bW,bX,bY){var bZ;return new _3((bZ={Attr:bT,Children:bU,El:bW,ElKey:bX},(bQ.SetOptional(bZ,"Delimiters",bV),bQ.SetOptional(bZ,"Render",bY),bZ)));};_5.StringApply=function(){bh.$cctor();return bh.StringApply;};_5.ApplyValue=function(bT,bU,bV){var bW;function bX(bY,bZ){return bZ==null?null:bY(bZ.$0);}bW=null;return[function(bY){function bZ(){bV.UpdateMaybe(function(b0){var b1;bW=bT(bY);return bW!=null&&bW.$==1&&(!I.Equals(bW.$0,b0)&&(b1=[bW,bW.$0],true))?b1[0]:null;});}bY.addEventListener("change",bZ);bY.addEventListener("input",bZ);bY.addEventListener("keypress",bZ);},function(bY){var bZ;bZ=bU(bY);return function(b0){return bX(bZ,b0);};},s.Map(function(bY){var bZ;return bW!=null&&bW.$==1&&(I.Equals(bW.$0,bY)&&(bZ=bW.$0,true))?null:{$:1,$0:bY};},bV.get_View())];};_5.StringSet=function(){bh.$cctor();return bh.StringSet;};_5.StringGet=function(){bh.$cctor();return bh.StringGet;};_5.DateTimeSetUnchecked=function(){bh.$cctor();return bh.DateTimeSetUnchecked;};_5.DateTimeGetUnchecked=function(){bh.$cctor();return bh.DateTimeGetUnchecked;};_5.FileApplyValue=function(bT,bU,bV){var bW;function bX(bY,bZ){return bZ==null?null:bY(bZ.$0);}bW=null;return[function(bY){bY.addEventListener("change",function(){bV.UpdateMaybe(function(bZ){var b0;bW=bT(bY);return bW!=null&&bW.$==1&&(bW.$0!==bZ&&(b0=[bW,bW.$0],true))?b0[0]:null;});});},function(bY){var bZ;bZ=bU(bY);return function(b0){return bX(bZ,b0);};},s.Map(function(bY){var bZ;return bW!=null&&bW.$==1&&(I.Equals(bW.$0,bY)&&(bZ=bW.$0,true))?null:{$:1,$0:bY};},bV.get_View())];};_5.FileSetUnchecked=function(){bh.$cctor();return bh.FileSetUnchecked;};_5.FileGetUnchecked=function(){bh.$cctor();return bh.FileGetUnchecked;};_5.IntSetUnchecked=function(){bh.$cctor();return bh.IntSetUnchecked;};_5.IntGetUnchecked=function(){bh.$cctor();return bh.IntGetUnchecked;};_5.IntSetChecked=function(){bh.$cctor();return bh.IntSetChecked;};_5.IntGetChecked=function(){bh.$cctor();return bh.IntGetChecked;};_5.FloatSetUnchecked=function(){bh.$cctor();return bh.FloatSetUnchecked;};_5.FloatGetUnchecked=function(){bh.$cctor();return bh.FloatGetUnchecked;};_5.FloatSetChecked=function(){bh.$cctor();return bh.FloatSetChecked;};_5.FloatGetChecked=function(){bh.$cctor();return bh.FloatGetChecked;};X.ofList=function(bT){var bU,bV;bV=[];bU=bT;while(!(bU.$==0)){bV.push(l.head(bU));bU=l.tail(bU);}return bV;};X.exists=function(bT,bU){var bV,bW,bX,bY;bV=false;bW=0;bY=X.length(bU);while(!bV&&bW<bY)if(bT(bU[bW]))bV=true;else bW=bW+1;return bV;};X.tryPick=function(bT,bU){var bV,bW,bX;bV=null;bW=0;while(bW<bU.length&&bV==null){bX=bT(bU[bW]);if(bX!=null&&bX.$==1)bV=bX;bW=bW+1;}return bV;};X.tryFindIndex=function(bT,bU){var bV,bW;bV=null;bW=0;while(bW<bU.length&&bV==null){bT(bU[bW])?bV={$:1,$0:bW}:void 0;bW=bW+1;}return bV;};X.filter=function(bT,bU){var bV,bW,bX;bV=[];for(bW=0,bX=bU.length-1;bW<=bX;bW++)if(bT(bU[bW]))bV.push(bU[bW]);return bV;};X.map=function(bT,bU){var bV,bW,bX;bV=new a.Array(bU.length);for(bW=0,bX=bU.length-1;bW<=bX;bW++)bV[bW]=bT(bU[bW]);return bV;};X.iter=function(bT,bU){var bV,bW;for(bV=0,bW=bU.length-1;bV<=bW;bV++)bT(bU[bV]);};X.foldBack=function(bT,bU,bV){var bW,bX,bY,bZ,b0;bW=bV;bY=bU.length;for(bZ=1,b0=bY;bZ<=b0;bZ++)bW=bT(bU[bY-bZ],bW);return bW;};X.pick=function(bT,bU){var bV;bV=X.tryPick(bT,bU);return bV==null?f.FailWith("KeyNotFoundException"):bV.$0;};X.concat=function(bT){return a.Array.prototype.concat.apply([],X.ofSeq(bT));};X.ofSeq=function(bT){var bU,bV;if(bT instanceof a.Array)return bT.slice();else if(bT instanceof m)return X.ofList(bT);else{bU=[];bV=V.Get(bT);try{while(bV.MoveNext())bU.push(bV.Current());return bU;}finally{if(typeof bV=="object"&&"Dispose"in bV)bV.Dispose();}}};X.choose=function(bT,bU){var bV,bW,bX,bY;bV=[];for(bW=0,bX=bU.length-1;bW<=bX;bW++){bY=bT(bU[bW]);if(bY==null);else bV.push(bY.$0);}return bV;};X.create=function(bT,bU){var bV,bW,bX;bV=new a.Array(bT);for(bW=0,bX=bT-1;bW<=bX;bW++)bV[bW]=bU;return bV;};X.init=function(bT,bU){var bV,bW,bX;if(bT<0)f.FailWith("Negative size given.");else null;bV=new a.Array(bT);for(bW=0,bX=bT-1;bW<=bX;bW++)bV[bW]=bU(bW);return bV;};X.forall=function(bT,bU){var bV,bW,bX,bY;bV=true;bW=0;bY=X.length(bU);while(bV&&bW<bY)if(bT(bU[bW]))bW=bW+1;else bV=false;return bV;};_6=j.Elt=bQ.Class({},r,_6);_6.New=function(bT,bU,bV){var bW,bX;bW=Q.CreateElemNode(bT,bU,bV.docNode);bX=bi.Create(bV.updates);return new _6.New$1({$:1,$0:bW},s.Map2Unit(R.Updates(bW.Attr),bX.v),bT,bX);};_6.New$1=bQ.Ctor(function(bT,bU,bV,bW){r.New.call(this,bT,bU);this.docNode$1=bT;this.updates$1=bU;this.elt=bV;this.rvUpdates=bW;},_6);_7.notPresent=function(){throw new bC.New();};_9.convertTextNode=function(bT){var bU,bV,bW,bX,bY,bZ;bU=null;bV=0;bX=bT.textContent;bY=new a.RegExp(z.TextHoleRE(),"g");while(bU=bY.exec(bX),bU!==null){bT.parentNode.insertBefore(self.document.createTextNode(_.string(bX,{$:1,$0:bV},{$:1,$0:bY.lastIndex-X.get(bU,0).length-1})),bT);bV=bY.lastIndex;bZ=self.document.createElement("span");bZ.setAttribute("ws-replace",X.get(bU,1).toLowerCase());bT.parentNode.insertBefore(bZ,bT);}bY.lastIndex=0;bT.textContent=_.string(bX,{$:1,$0:bV},null);};_9.failNotLoaded=function(bT){bR.warn("Instantiating non-loaded template",bT);};_9.fillTextHole=function(bT,bU,bV){var bW;bW=bT.querySelector("[ws-replace]");return I.Equals(bW,null)?(bR.warn("Filling non-existent text hole",bV),null):(bW.parentNode.replaceChild(self.document.createTextNode(bU),bW),{$:1,$0:bW.getAttribute("ws-replace")});};_9.removeHolesExcept=function(bT,bU){function bV(bW){z.foreachNotPreserved(bT,"["+bW+"]",function(bX){if(!bU.Contains(bX.getAttribute(bW)))bX.removeAttribute(bW);});}bV("ws-attr");bV("ws-onafterrender");bV("ws-var");z.foreachNotPreserved(bT,"[ws-hole]",function(bW){if(!bU.Contains(bW.getAttribute("ws-hole"))){bW.removeAttribute("ws-hole");while(bW.hasChildNodes())bW.removeChild(bW.lastChild);}});z.foreachNotPreserved(bT,"[ws-replace]",function(bW){if(!bU.Contains(bW.getAttribute("ws-replace")))bW.parentNode.removeChild(bW);});z.foreachNotPreserved(bT,"[ws-on]",function(bW){bW.setAttribute("ws-on",bj.concat(" ",X.filter(function(bX){return bU.Contains(X.get(bj.SplitChars(bX,[":"],1),1));},bj.SplitChars(bW.getAttribute("ws-on"),[" "],1))));});z.foreachNotPreserved(bT,"[ws-attr-holes]",function(bW){var bX,bY,bZ,b0,b1;bX=bj.SplitChars(bW.getAttribute("ws-attr-holes"),[" "],1);for(bY=0,bZ=bX.length-1;bY<=bZ;bY++){b0=X.get(bX,bY);bW.setAttribute(b0,(b1=new a.RegExp(z.TextHoleRE(),"g"),bW.getAttribute(b0).replace(b1,function(b2,b3){return bU.Contains(b3)?b2:"";})));}});};_9.fillInstanceAttrs=function(bT,bU){var bV,bW,bX,bY,bZ;_9.convertAttrs(bU);bV=bU.nodeName.toLowerCase();bW=bT.querySelector("[ws-attr="+bV+"]");if(I.Equals(bW,null))bR.warn("Filling non-existent attr hole",bV);else{bW.removeAttribute("ws-attr");for(bX=0,bY=bU.attributes.length-1;bX<=bY;bX++){bZ=bU.attributes.item(bX);if(bZ.name=="class"&&bW.hasAttribute("class"))bW.setAttribute("class",bW.getAttribute("class")+" "+bZ.nodeValue);else bW.setAttribute(bZ.name,bZ.nodeValue);}}};_9.mapHoles=function(bT,bU){function bV(bW){z.foreachNotPreserved(bT,"["+bW+"]",function(bX){var bY,bZ;bY=(bZ=null,[bU.TryGetValue(bX.getAttribute(bW).toLowerCase(),{get:function(){return bZ;},set:function(b0){bZ=b0;}}),bZ]);if(bY[0])bX.setAttribute(bW,bY[1]);});}bV("ws-hole");bV("ws-replace");bV("ws-attr");bV("ws-onafterrender");bV("ws-var");z.foreachNotPreserved(bT,"[ws-on]",function(bW){bW.setAttribute("ws-on",bj.concat(" ",X.map(function(bX){var bY,bZ,b0;bY=bj.SplitChars(bX,[":"],1);bZ=(b0=null,[bU.TryGetValue(X.get(bY,1),{get:function(){return b0;},set:function(b1){b0=b1;}}),b0]);return bZ[0]?X.get(bY,0)+":"+bZ[1]:bX;},bj.SplitChars(bW.getAttribute("ws-on"),[" "],1))));});z.foreachNotPreserved(bT,"[ws-attr-holes]",function(bW){var bX,bY,bZ;bX=bj.SplitChars(bW.getAttribute("ws-attr-holes"),[" "],1);for(bY=0,bZ=bX.length-1;bY<=bZ;bY++)(function(){var b0;function b1(b2,b3){var b4;b4=f.KeyValue(b3);return b2.replace(new a.RegExp("\\${"+b4[0]+"}","ig"),"${"+b4[1]+"}");}b0=X.get(bX,bY);return bW.setAttribute(b0,(((bQ.Curried3(G.fold))(b1))(bW.getAttribute(b0)))(bU));}());});};_9.fill=function(bT,bU,bV){while(true)if(bT.hasChildNodes())bV=bU.insertBefore(bT.lastChild,bV);else return null;};_9.convertAttrs=function(bT){var bV,bW,bX,bY,bZ,b0,b1,b2;function bU(b3){var b4;b4=bT.getAttribute(b3);if(b4==null);else bT.setAttribute(b3,b4.toLowerCase());}bV=bT.attributes;bW=[];bX=[];bY=[];for(bZ=0,b0=bV.length-1;bZ<=b0;bZ++){b1=bV.item(bZ);if(bj.StartsWith(b1.nodeName,"ws-on")&&b1.nodeName!="ws-onafterrender"&&b1.nodeName!="ws-on"){bW.push(b1.nodeName);bX.push(_.string(b1.nodeName,{$:1,$0:"ws-on".length},null)+":"+b1.nodeValue.toLowerCase());}else!bj.StartsWith(b1.nodeName,"ws-")&&(new a.RegExp(z.TextHoleRE())).test(b1.nodeValue)?(b1.nodeValue=(b2=new a.RegExp(z.TextHoleRE(),"g"),b1.nodeValue.replace(b2,function(b3,b4){return"${"+b4.toLowerCase()+"}";})),bY.push(b1.nodeName)):void 0;}if(!(bX.length==0))bT.setAttribute("ws-on",bj.concat(" ",bX));if(!(bY.length==0))bT.setAttribute("ws-attr-holes",bj.concat(" ",bY));bU("ws-hole");bU("ws-replace");bU("ws-attr");bU("ws-onafterrender");bU("ws-var");X.iter(function(b3){bT.removeAttribute(b3);},bW);};_.string=function(bT,bU,bV){var bW,bX;return bU==null?bV!=null&&bV.$==1?(bW=bV.$0,bW<0?"":bT.slice(0,bW+1)):"":bV==null?bT.slice(bU.$0):(bX=bV.$0,bX<0?"":bT.slice(bU.$0,bX+1));};G.insufficient=function(){return f.FailWith("The input sequence has an insufficient number of elements.");};G.nonNegative=function(){return f.FailWith("The input must be non-negative.");};$=L.KeyCollection=bQ.Class({GetEnumerator:function(){return V.Get(G.map(function(bT){return bT.K;},this.d));}},i,$);$.New=bQ.Ctor(function(bT){i.New.call(this);this.d=bT;},$);ba.TryParseInt32=function(bT,bU){return ba.TryParse(bT,-2147483648,2147483647,bU);};bb.get_UseAnimations=function(){return bo.UseAnimations();};bb.Play=function(bT){var bU;bU=null;return bn.Delay(function(){return bn.Bind(bb.Run(a.ignore,bo.Actions(bT)),function(){bo.Finalize(bT);return bn.Return(null);});});};bb.Append=function(bT,bU){return{$:0,$0:bw.Append(bT.$0,bU.$0)};};bb.Run=function(bT,bU){var bV;function bW(bX){function bY(bZ){return function(b0){var b1;b1=b0-bZ;bU.Compute(b1);bT();return b1<=bV?void a.requestAnimationFrame(function(b2){(bY(bZ))(b2);}):bX();};}a.requestAnimationFrame(function(bZ){(bY(bZ))(bZ);});}bV=bU.Duration;return bV===0?bn.Zero():bn.FromContinuations(function(bX,bY,bZ){return bW.apply(null,[bX,bY,bZ]);});};bb.Concat=function(bT){return{$:0,$0:bw.Concat(G.map(bo.List,bT))};};bb.get_Empty=function(){return{$:0,$0:bw.Empty()};};bc.BatchUpdatesEnabled=function(){bp.$cctor();return bp.BatchUpdatesEnabled;};bd.StartProcessor=function(bT){var bU;function bV(){var bW;bW=null;return bn.Delay(function(){return bn.Bind(bT,function(){var bX;bX=bU[0];return I.Equals(bX,1)?(bU[0]=0,bn.Zero()):I.Equals(bX,2)?(bU[0]=1,bV()):bn.Zero();});});}bU=[0];return function(){var bW;bW=bU[0];if(I.Equals(bW,0)){bU[0]=1;bn.Start(bV(),null);}else I.Equals(bW,1)?bU[0]=2:void 0;};};be.$cctor=function(){var bT;be.$cctor=a.ignore;be.lastId=[0];be.Int=(bT=[0],function(){bT[0]++;return bT[0];});};bg.New=function(bT,bU,bV,bW){var bX;bX={DynElem:bT,DynFlags:bU,DynNodes:bV};bQ.SetOptional(bX,"OnAfterRender",bW);return bX;};bh.$cctor=function(){var bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6;bh.$cctor=a.ignore;bh.EmptyAttr=null;bh.BoolCheckedApply=function(b7){function b8(b9,b_){return b_!=null&&b_.$==1?void(b9.checked=b_.$0):null;}return[function(b9){b9.addEventListener("change",function(){return b7.Get()!=b9.checked?b7.Set(b9.checked):null;});},function(b9){return function(b_){return b8(b9,b_);};},s.Map(function(b9){return{$:1,$0:b9};},b7.get_View())];};bh.StringSet=function(b7){return function(b8){b7.value=b8;};};bh.StringGet=function(b7){return{$:1,$0:b7.value};};bh.StringApply=(bT=_5.StringGet(),(bU=_5.StringSet(),function(b7){return _5.ApplyValue(bT,bU,b7);}));bh.DateTimeSetUnchecked=function(b7){return function(b8){b7.value=(new a.Date(b8)).toLocaleString();};};bh.DateTimeGetUnchecked=function(b7){var b8,b9,b_,b$;b8=b7.value;return bs.isBlank(b8)?{$:1,$0:-8640000000000000}:(b9=(b_=0,[(b$=bA.TryParse(b8),b$!=null&&b$.$==1&&(b_=b$.$0,true)),b_]),b9[0]?{$:1,$0:b9[1]}:null);};bh.DateTimeApplyUnchecked=(bV=_5.DateTimeGetUnchecked(),(bW=_5.DateTimeSetUnchecked(),function(b7){return _5.ApplyValue(bV,bW,b7);}));bh.FileSetUnchecked=function(){return function(){return null;};};bh.FileGetUnchecked=function(b7){var b8;b8=b7.files;return{$:1,$0:X.ofSeq(G.delay(function(){return G.map(function(b9){return b8.item(b9);},f.range(0,b8.length-1));}))};};bh.FileApplyUnchecked=(bX=_5.FileGetUnchecked(),(bY=_5.FileSetUnchecked(),function(b7){return _5.FileApplyValue(bX,bY,b7);}));bh.IntSetUnchecked=function(b7){return function(b8){b7.value=a.String(b8);};};bh.IntGetUnchecked=function(b7){var b8,b9;b8=b7.value;return bs.isBlank(b8)?{$:1,$0:0}:(b9=+b8,b9!==b9>>0?null:{$:1,$0:b9});};bh.IntApplyUnchecked=(bZ=_5.IntGetUnchecked(),(b0=_5.IntSetUnchecked(),function(b7){return _5.ApplyValue(bZ,b0,b7);}));bh.IntSetChecked=function(b7){return function(b8){var b9;b9=b8.get_Input();return b7.value!=b9?void(b7.value=b9):null;};};bh.IntGetChecked=function(b7){var b8,b9,b_;b8=b7.value;return{$:1,$0:bs.isBlank(b8)?(b7.checkValidity?b7.checkValidity():true)?new bt({$:2,$0:b8}):new bt({$:1,$0:b8}):(b9=(b_=0,[ba.TryParseInt32(b8,{get:function(){return b_;},set:function(b$){b_=b$;}}),b_]),b9[0]?new bt({$:0,$0:b9[1],$1:b8}):new bt({$:1,$0:b8}))};};bh.IntApplyChecked=(b1=_5.IntGetChecked(),(b2=_5.IntSetChecked(),function(b7){return _5.ApplyValue(b1,b2,b7);}));bh.FloatSetUnchecked=function(b7){return function(b8){b7.value=a.String(b8);};};bh.FloatGetUnchecked=function(b7){var b8,b9;b8=b7.value;return bs.isBlank(b8)?{$:1,$0:0}:(b9=+b8,a.isNaN(b9)?null:{$:1,$0:b9});};bh.FloatApplyUnchecked=(b3=_5.FloatGetUnchecked(),(b4=_5.FloatSetUnchecked(),function(b7){return _5.ApplyValue(b3,b4,b7);}));bh.FloatSetChecked=function(b7){return function(b8){var b9;b9=b8.get_Input();return b7.value!=b9?void(b7.value=b9):null;};};bh.FloatGetChecked=function(b7){var b8,b9;b8=b7.value;return{$:1,$0:bs.isBlank(b8)?(b7.checkValidity?b7.checkValidity():true)?new bt({$:2,$0:b8}):new bt({$:1,$0:b8}):(b9=+b8,a.isNaN(b9)?new bt({$:1,$0:b8}):new bt({$:0,$0:b9,$1:b8}))};};bh.FloatApplyChecked=(b5=_5.FloatGetChecked(),(b6=_5.FloatSetChecked(),function(b7){return _5.ApplyValue(b5,b6,b7);}));};bi=j.Updates=bQ.Class({},null,bi);bi.Create=function(bT){var bU;bU=null;bU=bi.New(bT,null,function(){var bV;bV=bU.s;return bV===null?(bV=E.Copy(bU.c()),bU.s=bV,E.WhenObsoleteRun(bV,function(){bU.s=null;}),bV):bV;});return bU;};bi.New=function(bT,bU,bV){return new bi({c:bT,s:bU,v:bV});};bj.concat=function(bT,bU){return X.ofSeq(bU).join(bT);};bj.SplitChars=function(bT,bU,bV){return bj.Split(bT,new a.RegExp("["+bj.RegexEscape(bU.join(""))+"]"),bV);};bj.StartsWith=function(bT,bU){return bT.substring(0,bU.length)==bU;};bj.Split=function(bT,bU,bV){return bV===1?X.filter(function(bW){return bW!=="";},bj.SplitWith(bT,bU)):bj.SplitWith(bT,bU);};bj.RegexEscape=function(bT){return bT.replace(new a.RegExp("[-\\/\\\\^$*+?.()|[\\]{}]","g"),"\\$&");};bj.forall=function(bT,bU){return G.forall(bT,bj.protect(bU));};bj.SplitWith=function(bT,bU){return bT.split(bU);};bj.protect=function(bT){return bT==null?"":bT;};bl.New=function(bT,bU){return{PreviousNodes:bT,Top:bU};};bm.get_Empty=function(){return{$:0,$0:new Z.New$3()};};bm.FindAll=function(bT){var bU;function bV(bY,bZ){var b0,b1,b2,b3,b4;while(true)switch(bY){case 0:if(bZ!=null&&bZ.$==0){b1=bZ.$1;b2=bZ.$0;bV(0,b2);bZ=b1;}else if(bZ!=null&&bZ.$==1){b3=bZ.$0;bZ=b3;bY=1;}else if(bZ!=null&&bZ.$==2){b4=bZ.$0;bZ=b4.Current;}else return bZ!=null&&bZ.$==6?(b0=bZ.$0.Holes,(function(b5){return function(b6){X.iter(b5,b6);};}(bX))(b0)):null;break;case 1:bU.push(bZ);bZ=bZ.Children;bY=0;break;}}function bW(bY){return bV(0,bY);}function bX(bY){return bV(1,bY);}bU=[];bW(bT);return{$:0,$0:new Z.New$2(bU)};};bm.Filter=function(bT,bU){return{$:0,$0:bI.Filter(bT,bU.$0)};};bm.Except=function(bT,bU){return{$:0,$0:bI.Except(bT.$0,bU.$0)};};bm.ToArray=function(bT){return bI.ToArray(bT.$0);};bm.Intersect=function(bT,bU){return{$:0,$0:bI.Intersect(bT.$0,bU.$0)};};bn.Delay=function(bT){return function(bU){try{(bT(null))(bU);}catch(bV){bU.k({$:1,$0:bV});}};};bn.Bind=function(bT,bU){return bn.checkCancel(function(bV){bT(bF.New(function(bW){var bX;if(bW.$==0){bX=bW.$0;bn.scheduler().Fork(function(){try{(bU(bX))(bV);}catch(bY){bV.k({$:1,$0:bY});}});}else bn.scheduler().Fork(function(){bV.k(bW);});},bV.ct));});};bn.Zero=function(){bG.$cctor();return bG.Zero;};bn.Start=function(bT,bU){var bV,bW;bV=(bW=(bn.defCTS())[0],bU==null?bW:bU.$0);bn.scheduler().Fork(function(){if(!bV.c)bT(bF.New(function(bX){if(bX.$==1)bn.UncaughtAsyncError(bX.$0);},bV));});};bn.Return=function(bT){return function(bU){bU.k({$:0,$0:bT});};};bn.scheduler=function(){bG.$cctor();return bG.scheduler;};bn.checkCancel=function(bT){return function(bU){if(bU.ct.c)bn.cancel(bU);else bT(bU);};};bn.defCTS=function(){bG.$cctor();return bG.defCTS;};bn.UncaughtAsyncError=function(bT){bR.log("WebSharper: Uncaught asynchronous exception",bT);};bn.FromContinuations=function(bT){return function(bU){var bV;function bW(bX){if(bV[0])f.FailWith("A continuation provided by Async.FromContinuations was invoked multiple times");else{bV[0]=true;bn.scheduler().Fork(bX);}}bV=[false];bT(function(bX){bW(function(){bU.k({$:0,$0:bX});});},function(bX){bW(function(){bU.k({$:1,$0:bX});});},function(bX){bW(function(){bU.k({$:2,$0:bX});});});};};bn.cancel=function(bT){bT.k({$:2,$0:new bL.New(bT.ct)});};bo.UseAnimations=function(){bv.$cctor();return bv.UseAnimations;};bo.Actions=function(bT){return bo.ConcatActions(X.choose(function(bU){return bU.$==1?{$:1,$0:bU.$0}:null;},bw.ToArray(bT.$0)));};bo.Finalize=function(bT){X.iter(function(bU){if(bU.$==0)bU.$0();},bw.ToArray(bT.$0));};bo.ConcatActions=function(bT){var bU,bV,bW,bX;bU=U.ofSeqNonCopying(bT);bV=X.length(bU);return bV===0?bo.Const():bV===1?X.get(bU,0):(bW=G.max(G.map(function(bY){return bY.Duration;},bU)),(bX=X.map(function(bY){return bo.Prolong(bW,bY);},bU),bo.Def(bW,function(bY){X.iter(function(bZ){bZ.Compute(bY);},bX);})));};bo.List=function(bT){return bT.$0;};bo.Const=function(bT){return bo.Def(0,function(){return bT;});};bo.Def=function(bT,bU){return{Compute:bU,Duration:bT};};bo.Prolong=function(bT,bU){var bV,bW,bX;bV=bU.Compute;bW=bU.Duration;bX=bM.Create(function(){return bU.Compute(bU.Duration);});return{Compute:function(bY){return bY>=bW?bX.f():bV(bY);},Duration:bT};};bp.$cctor=function(){bp.$cctor=a.ignore;bp.BatchUpdatesEnabled=true;};bq.$cctor=function(){bq.$cctor=a.ignore;bq.counter=0;};br.Clear=function(bT){bT.splice(0,X.length(bT));};bs.isBlank=function(bT){return bj.forall(bz.IsWhiteSpace,bT);};bt=j.CheckedInput=bQ.Class({get_Input:function(){return this.$==1?this.$0:this.$==2?this.$0:this.$1;}},null,bt);bu.$cctor=function(){var bT;bu.$cctor=a.ignore;bu.rxhtmlTag=new a.RegExp("<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>","gi");bu.rtagName=new a.RegExp("<([\\w:]+)");bu.rhtml=new a.RegExp("<|&#?\\w+;");bu.wrapMap=(bT=[1,"<table>","</table>"],{option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:bT,tbody:bT,tfoot:bT,tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><colgroup>","</colgoup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"]});bu.defaultWrap=[0,"",""];};bv.$cctor=function(){bv.$cctor=a.ignore;bv.CubicInOut=bE.Custom(function(bT){var bU;bU=bT*bT;return 3*bU-2*(bU*bT);});bv.UseAnimations=true;};bw.Append=function(bT,bU){return bT.$==0?bU:bU.$==0?bT:{$:2,$0:bT,$1:bU};};bw.ToArray=function(bT){var bU;function bV(bW){var bX,bY;while(true)if(bW.$==1)return bU.push(bW.$0);else if(bW.$==2){bX=bW.$1;bY=bW.$0;bV(bY);bW=bX;}else return bW.$==3?X.iter(function(bZ){bU.push(bZ);},bW.$0):null;}bU=[];bV(bT);return bU.slice(0);};bw.Concat=function(bT){var bU;bU=U.ofSeqNonCopying(bT);return U.TreeReduce(bw.Empty(),bw.Append,bU);};bw.Empty=function(){bN.$cctor();return bN.Empty;};bx.concat=function(bT){var bU,bV;bU=[];for(var bW in bT)bU.push.apply(bU,bT[bW]);return bU;};by=j.DynamicAttrNode=bQ.Class({NChanged:function(){return this.updates;},NGetExitAnim:function(bT){return bb.get_Empty();},NGetEnterAnim:function(bT){return bb.get_Empty();},NGetChangeAnim:function(bT){return bb.get_Empty();},NSync:function(bT){if(this.dirty){(this.push(bT))(this.value);this.dirty=false;}}},i,by);by.New=bQ.Ctor(function(bT,bU){var bV;bV=this;i.New.call(this);this.push=bU;this.value=void 0;this.dirty=false;this.updates=s.Map(function(bW){bV.value=bW;bV.dirty=true;},bT);},by);bz.IsWhiteSpace=function(bT){return bT.match(new a.RegExp("\\s"))!==null;};bA.TryParse=function(bT){var bU;bU=bS.parse(bT);return a.isNaN(bU)?null:{$:1,$0:bU};};ba.TryParse=function(bT,bU,bV,bW){var bX,bY;bX=+bT;bY=bX===bX-bX%1&&bX>=bU&&bX<=bV;if(bY)bW.set(bX);return bY;};bC=e.KeyNotFoundException=bQ.Class({},bB,bC);bC.New=bQ.Ctor(function(){bC.New$1.call(this,"The given key was not present in the dictionary.");},bC);bC.New$1=bQ.Ctor(function(bT){this.message=bT;O.setPrototypeOf(this,bC.prototype);},bC);bD=bn.Scheduler=bQ.Class({Fork:function(bT){var bU;bU=this;this.robin.push(bT);if(this.idle){this.idle=false;a.setTimeout(function(){bU.tick();},0);}},tick:function(){var bT,bU,bV;bU=this;bV=bS.now();bT=true;while(bT)if(this.robin.length===0){this.idle=true;bT=false;}else{(this.robin.shift())();bS.now()-bV>40?(a.setTimeout(function(){bU.tick();},0),bT=false):void 0;}}},i,bD);bD.New=bQ.Ctor(function(){i.New.call(this);this.idle=true;this.robin=[];},bD);bE=j.Easing=bQ.Class({},i,bE);bE.Custom=function(bT){return new bE.New(bT);};bE.New=bQ.Ctor(function(bT){i.New.call(this);this.transformTime=bT;},bE);bF.New=function(bT,bU){return{k:bT,ct:bU};};bG.$cctor=function(){bG.$cctor=a.ignore;bG.noneCT=bH.New(false,[]);bG.scheduler=new bD.New();bG.defCTS=[new bJ.New()];bG.Zero=bn.Return();bG.GetCT=function(bT){bT.k({$:0,$0:bT.ct});};};bH.New=function(bT,bU){return{c:bT,r:bU};};bI.Filter=function(bT,bU){return new Z.New$2(X.filter(bT,bI.ToArray(bU)));};bI.Except=function(bT,bU){var bV;bV=new Z.New$2(bI.ToArray(bU));bV.ExceptWith(bI.ToArray(bT));return bV;};bI.ToArray=function(bT){var bU;bU=X.create(bT.Count(),void 0);bT.CopyTo(bU,0);return bU;};bI.Intersect=function(bT,bU){var bV;bV=new Z.New$2(bI.ToArray(bT));bV.IntersectWith(bI.ToArray(bU));return bV;};bJ=e.CancellationTokenSource=bQ.Class({},i,bJ);bJ.New=bQ.Ctor(function(){i.New.call(this);this.c=false;this.pending=null;this.r=[];this.init=1;},bJ);bK.Children=function(bT,bU){var bV,bW,bX;if(bU!=null&&bU.$==1){bX=[];bV=bU.$0[0].nextSibling;while(bV!==bU.$0[1]){bX.push(bV);bV=bV.nextSibling;}return{$:0,$0:bX};}else return{$:0,$0:X.init(bT.childNodes.length,(bW=bT.childNodes,function(bY){return bW[bY];}))};};bK.Except=function(bT,bU){var bV;bV=bT.$0;return{$:0,$0:X.filter(function(bW){return X.forall(function(bX){return!(bW===bX);},bV);},bU.$0)};};bK.Iter=function(bT,bU){X.iter(bT,bU.$0);};bK.DocChildren=function(bT){var bU;function bV(bW){var bX,bY,bZ,b0;while(true){if(bW!=null&&bW.$==2){bY=bW.$0;bW=bY.Current;}else if(bW!=null&&bW.$==1)return bU.push(bW.$0.El);else if(bW==null)return null;else if(bW!=null&&bW.$==5)return bU.push(bW.$0);else if(bW!=null&&bW.$==4)return bU.push(bW.$0.Text);else if(bW!=null&&bW.$==6){bX=bW.$0.Els;return(function(b1){return function(b2){X.iter(b1,b2);};}(function(b1){if(b1==null||b1.constructor===O)bV(b1);else bU.push(b1);}))(bX);}else{bZ=bW.$1;b0=bW.$0;bV(b0);bW=bZ;}}}bU=[];bV(bT.Children);return{$:0,$0:U.ofSeqNonCopying(bU)};};bL=e.OperationCanceledException=bQ.Class({},bB,bL);bL.New=bQ.Ctor(function(bT){bL.New$1.call(this,"The operation was canceled.",null,bT);},bL);bL.New$1=bQ.Ctor(function(bT,bU,bV){this.message=bT;this.inner=bU;O.setPrototypeOf(this,bL.prototype);this.ct=bV;},bL);bM.Create=function(bT){return bP.New(false,bT,bM.forceLazy);};bM.forceLazy=function(){var bT;bT=this.v();this.c=true;this.v=bT;this.f=bM.cachedLazy;return bT;};bM.cachedLazy=function(){return this.v;};bN.$cctor=function(){bN.$cctor=a.ignore;bN.Empty={$:0};};bP.New=function(bT,bU,bV){return{c:bT,v:bU,f:bV};};bQ.OnLoad(function(){c.Main();});}(self));


if (typeof WebSharper !=='undefined') {
  WebSharper.Runtime.ScriptBasePath = '/Content/';
  WebSharper.Runtime.Start();
}
